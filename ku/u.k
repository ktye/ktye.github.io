W:400;H:300                /window size
K:{key@`k \x}              /key callback /G (X+:7)+f7@`key \x} /key callback
M:{ff.`M \x;mas[xy-D`x`y]} /mouse

key:k0:{x}              /callback for active widget type
mas:m0:{(x;y)}
commit:{`commit \x;$[x;(F[I]::D)I;D]}
CX:CY:0

F:+`t`x`y`X`Y`CX`CY`v!(`text`text`text;0 200 0;0 150 150;200 400 200;150 300 300;0 0 0;0 0 0;("";"";""))  /frame table
D:F I:0

mtext:{`mtext \x}
ktext:{D[`v]::$[x~8;-1_D`v;x~10;commit[1]`v;x':abc,32;(D`v),_x;D`v];fill[white;(D`x`y`X`Y)];P[black;((D`x)+W*D`y)+,/{x+f7 y}'[7*!#D`v;D`v]]}



Mas:``text`edit!(m0;mtext;medit)
Key:``text`edit!(k0;ktext;kedit)


ff:{i:0|*&(</'+x<F`x`X)&</'+y<F`y`Y;frame[c0;D`x`y`X`Y];commit[~i~I];D::F I::i
 key::Key D`t;mas::Mas D`t;         frame[c1;D`x`y`X`Y]}

frame:{[c;r]P[c;(v+w-1),(v:(W*!h)+x+y*W),t,(W*-1+h:-/r 3 1)+t:(W*y:r 1)+(x:r 0)+!w:-/r 2 0];r}
fill: {[c;r]P[c;((1+r 0)+W*1+r 1)+,/(W*!-2+-/r 3 1)+\:!(-2+-/r 2 0) ];r}

X:-7


abc:0+":+-*%&|<>=!~,^#_$?@.0123456789'/\\;`\"(){}[]abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"

white:16777215;black:0
c0:11184810 /#aaa
c1:255*256

/font 7x13  (each char has 88 bits instead of 91)
bits:{2/128 64 32 16 8 4 2 1\256+x}
chr7:{(7/x)+W*7\x:&,/bits'x}
f7:chr7'@[127#,"";abc
-11^,/(0x000000030600000060c00000000081023f881020000000000000001f0000000000000042a28a840000000000000184994d041653243000
 0x0000c24486194a8911d000002040810204081020408000000041041010101000000000010101010410400000000000001f807e000000000000c1
 0x83060c100060c000000000000e670000000000000000000000000030618000004082851122000000000001224fc9127e48912000000000000000
 0x00000007f00020e2a506060a14a8e0800001e020408e10004080000000e229d4a9569280e000000000000000000060c0000000e2244891224488
 0xe00000004185020408102040000000e2204082082081f0000000e2204086020488e000000020c289227e081020000001f2040f01020488e00000
 0x00e224081e224488e0000001f020410408204080000000e224488e224488e0000000e224488f020488e000003061800000000000000000081040
 0x820408204102000081010202040808101020000000030600000060c3000030c180000000000000000050a1400000000000000000184082040810
 0x2020406000c040808102040820430000184081010c041020406000c040810406101020430000384081020408102040e000e04081020408102043
 0x800000000388811e4488e800008102058c91224489e00000000001c410204040700000081023c891224498d0000000000388913e4088e0000038
 0x8107c408102040800000000003c891224c681023008102058c912244891000002040070204081020400000102007810204081020470102040892
 0x28709112100000e04081020408102040000000000a5b64c993264800000000058c912244891000000000038891224488e000000000058c912244
 0x89e20400000003c891224498d02000000002c608102040800000000003c8101c0409e00000008107c4081020407000000000044891224498d000
 0x0000000448911428204000000000083264d54489100000000004488a0828891000000000044891142820410600000007c082082081f0000000c1
 0x8489127e850a10000001e224489e224489e00000007124081020404070000001c2444891224491c0000001f204081e204081f0000000f102040f
 0x1020408000000071240810224448700000011224489f22448910000001f0810204081021f0000001f0810204081023800000021449143848890a
 0x1000000081020408102040f0000002166cd6ad5a850a1000000113264a95264c8910000000c24850a1428490c0000001e22448913c4081000000
 0x00c24850a1428490c0c00001e224489e24448910000000f2040c0e060409e0000003f88102040810204000000112244891224488e00000021428
 0x5092244860c00000020c99326ab644891000000112228504142889100000011224450a08102040000001f0208104102081f000)]
 
