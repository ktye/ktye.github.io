<html>
<head><meta charset="utf-8"><title>w</title></head>
<link rel='icon' type'image/png' href="k32.png">
<style>
 html,body,textarea{height:100%;margin:0;padding:0;overflow:hidden;}
 #kons{top:0;left:0;width:100%;height:100%;position:absolute;border:0pt;resize:none;font-family:monospace;overflow:auto;}
 .term{background:black;color:white}
 .hold{background:white;color:black}
 .edit{background:#ffffea;color:black}
 #cnv{width:100;height:100;top:0;right:0;position:absolute;}
 #dl{display:none;}
</style>
<body>
<textarea id="kons" class="term" wrap="off" autofocus spellcheck="false"></textarea>
<canvas id="cnv"></canvas>
<script>
var r = "AGFzbQEAAAABPAlgAX8Bf2ACf38Bf2ABfAF/YAF/AGADf39/AX9gA39/fwBgA39/fgF/YAZ/f39/f38AYAd/f39/f39/AAM0MwABAQACAQEDAwMDAAQAAQAAAQEBAQEFAQEBAAAAAAABAQEBAQQEBgQBAQAAAAcIAQEBAQQEAXAABgUDAQABB7oCNANtZW0CAANpbmkAAAJiawABAm1rAAIDbWtpAAMDbWtmAAQDbWtkAAUDbWt6AAYCZnIABwJkeAAIAnJ4AAkCcmwACgN0aWwACwNzZXEADAN0aXIADQNhdHgADgNyZXYADwNmc3QAEANjdXQAEQRkcm9wABIDcnNoABMEcHJvZAAUBHRha2UAFQJtdgAWA2NhdAAXBHVjYXQAGARsY2F0ABkDZW5sABoDY250ABsDdGlwABwDd2VyAB0Dbm90AB4DZXFsAB8DbXRjACAFbWF0Y2gAIQNmbmQAIgNmbngAIwNmbmMAJANmbmkAJQNmbmoAJgNmbmwAJwNleGMAKAJ1cAApA3NydAAqA2dkbgArA2dyZAAsBG1zcnQALQRtcmdlAC4DZ3RjAC8DZ3RpADADZ3RmADEDZ3RsADIJCwEAQQELBS8wMTIyCtApM04BAn9BAEKAgpDAwICBggQ3AwBBgAEgADYCAEGAAiEBQQghAgJAA0AgAiAASUUNAUEEIAJsIAE2AgAgAUECbCEBIAJBAWohAgwACwsgAAsiAQF/QSBBByABIAAtAABsamdrIQIgAkEESQRAQQQPCyACC54BAQV/IAAgARABIQJBBCACbCEDAkADQCADKAIARUUNASADQQRqIQMMAAsLQYABIANGBEAACyADKAIAIQQgAyAEKAIANgIAIANBBGshBQJAA0AgBUEEIAJsT0UNASAEQQEgBUECdnRqIQYgBiAFKAIANgIAIAUgBjYCACAFQQRrIQUMAAsLIAQgASAAQR10cjYCACAEQQRqQQE2AgAgBAsYAQF/QQJBARACIQEgAUEIaiAANgIAIAELGAEBf0EDQQEQAiEBIAFBCGogADkDACABC7YBAQd/IAAoAgBBHXYhAiAAKAIAQf////8BcSEDQQggAGohBCABKAIAQR12IQUgASgCAEH/////AXEhBkEIIAFqIQcgAiAFRkUEQAALIANBAUYgBkEBS3EEQCAAIAYQFSEAIAYhAyAAQQhqIQQLIAZBAUYgA0EBS3EEQCABIAMQFSEBIAMhBiABQQhqIQcLIAMgBkZFBEAAC0EHQQIQAiEIIAhBCGogADYCACAIQQxqIAE2AgAgCAsbAQF/IAAgARAFIQIgAkECQQZBHXRyNgIAIAILPwEEfyAAKAIAQR12IQEgACgCAEH/////AXEhAkEIIABqIQNBBCABIAIQAWwhBCAAIAQoAgA2AgAgBCAANgIAC3wBBX8gAEH/AUsEQCAAQQRqKAIAIQEgAEEEaiABQQFrNgIAQQEgAUYEQCAAKAIAQR12IQIgACgCAEH/////AXEhA0EIIABqIQQgAkEDSwRAIAMEQEEAIQUDQCAEQQQgBWxqKAIAEAggBUEBaiIFIANJDQALCwsgABAHCwsLHwAgAEH/AUsEQCAAQQRqIQAgAEEBIAAoAgBqNgIACwtJAQR/IAAoAgBBHXYhASAAKAIAQf////8BcSECQQggAGohAyACBEBBACEEA0AgAygCABAJIANBBGohAyAEQQFqIgQgAkkNAAsLC1ABBH8gACgCAEEddiEBIAAoAgBB/////wFxIQJBCCAAaiEDQQIgAUZFBEAACyADKAIAIQQgABAIIARBAEgEQEEAIARrEA0PC0EAIARBARAMC0EBA39BAiABEAIhA0EIIANqIQQgAQRAQQAhBQNAIAQgAiAFIABqbDYCACAEQQRqIQQgBUEBaiIFIAFJDQALCyADC0EBA39BAiAAEAIhAUEEIAFBBCAAbGpqIQIgAARAQQAhAwNAIAIgAzYCACACQQRrIQIgA0EBaiIDIABJDQALCyABC7sEAQt/IAAoAgBBHXYhAiAAKAIAQf////8BcSEDQQggAGohBCABKAIAQR12IQUgASgCAEH/////AXEhBkEIIAFqIQcgBUECRkUEQAALIAIgBhACIQggCEEIaiEJAkACQAJAAkACQAJAAkACQCACDgYAAQIDBAUGCwAMBgsgBgRAQQAhDANAIAkgDGpBIDoAACAHKAIAIQogCiADSQRAIAkgDGogBCAKai0AADoAAAsgB0EEaiEHIAxBAWoiDCAGSQ0ACwsMBQsgBgRAQQAhDANAIAlBgICAgHg2AgAgBygCACEKIAogA0kEQCAJIARBBCAKbGooAgA2AgALIAlBBGohCSAHQQRqIQcgDEEBaiIMIAZJDQALCwwECyAGBEBBACEMA0AgCUQBAAAAAAD4fzkDACAHKAIAIQogCiADSQRAIAkgBEEIIApsaisDADkDAAsgCUEIaiEJIAdBBGohByAMQQFqIgwgBkkNAAsLDAMLQQFBABACIQsgBgRAQQAhDANAIAkgCzYCACAHKAIAIQogCiADSQRAIAkgBEEEIApsaigCADYCAAsgCUEEaiEJIAdBBGohByAMQQFqIgwgBkkNAAsLIAgQCiALEAgMAgtBAUEAEAIhCyAGBEBBACEMA0AgCSALNgIAIAcoAgAhCiAKIANJBEAgCSAEQQQgCmxqKAIANgIACyAJQQRqIQkgB0EEaiEHIAxBAWoiDCAGSQ0ACwsgCBAKIAsQCAwBCwAMAAsgABAIIAEQCCAICzQBA38gACgCAEEddiEBIAAoAgBB/////wFxIQJBCCAAaiEDIAJFBEAgAA8LIAAgAhANEA4LRgEDfyAAKAIAQR12IQEgACgCAEH/////AXEhAkEIIABqIQMgAUEHRgRAQQwgAGoQCSAAEAhBDCAAahAQDwsgAEEAEAMQDgvmAQELfyAAKAIAQR12IQIgACgCAEH/////AXEhA0EIIABqIQQgASgCAEEddiEFIAEoAgBB/////wFxIQZBCCABaiEHIAJBAkZFBEAACyADQQFGBEAgASAEKAIAEBIhCCAAEAggCA8LQQUgAxACIQggCEEIaiEJIAMEQEEAIQwDQCAEKAIAIQogBEEEaigCACELIAwgA0EBa0YEQCAGIQsLIAsgCkkEQAALIAEQCSAJIAEgCiALIAprQQEQDBAONgIAIARBBGohBCAJQQRqIQkgDEEBaiIMIANJDQALCyAAEAggARAIIAgLOwEDfyAAKAIAQR12IQIgACgCAEH/////AXEhA0EIIABqIQQgASADSwRAAAsgACABIAMgAWtBARAMEA4LyAEBC38gACgCAEEddiECIAAoAgBB/////wFxIQNBCCAAaiEEIAEoAgBBHXYhBSABKAIAQf////8BcSEGQQggAWohByACQQJGRQRAAAsgBCADEBQhCCABIAgQFSEJIANBAUYEQCAAEAggCQ8LIANBAWshAyAEQQQgA2xqIQogAwRAQQAhDANAIAooAgAhCyAIIAtuIQggBCADIAxrEBQhCEEAIAggCxAMIAkQESEJIApBBGshCiAMQQFqIgwgA0kNAAsLIAAQ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"
var rt = "NSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvNQo1IHRpbCAgICAgICAgICAgICAgICAgICAgICAgICAgIC8wIDEgMiAzIDQKNSB0aWwgcmV2ICAgICAgICAgICAgICAgICAgICAgICAvNCAzIDIgMSAwCiJhYmNkIiAgICAgICAgICAgICAgICAgICAgICAgICAgLyJhYmNkIgoiYWJjZCIgcmV2ICAgICAgICAgICAgICAgICAgICAgIC8iZGNiYSIKMSwyLDMgICAgICAgICAgICAgICAgICAgICAgICAgICAvMSAyIDMKMSwyLiwzICAgICAgICAgICAgICAgICAgICAgICAgICAvMSAyIDNmCjQsNSwzLDIgcmV2ICAgICAgICAgICAgICAgICAgICAgLzIgMyA1IDQKNCw1LDMsMiAgMSwzIGF0eCAgICAgICAgICAgICAgICAvNSAyCjQsNSwzLDIuIDEsMyBhdHggICAgICAgICAgICAgICAgLzUgMmYKNSB0aWwgcmV2IDMgdGlsIGF0eCAgICAgICAgICAgICAvNCAzIDIKMyB0aWwgcmV2IDUgdGlsIGF0eCAgICAgICAgICAgICAvMiAxIDAgME4gME4KImFiYyIgNCB0aWwgYXR4ICAgICAgICAgICAgICAgICAvImFiYyAiCjUgdGlsIHJldiBmc3QgICAgICAgICAgICAgICAgICAgLzQKMyA1IHRpbCByc2ggICAgICAgICAgICAgICAgICAgICAvMCAxIDIKNSAzIHRpbCByc2ggICAgICAgICAgICAgICAgICAgICAvMCAxIDIgMCAxCjIsMyA0IHRpbCByc2ggICAgICAgICAgICAgICAgICAgLygwIDEgMjszIDAgMSkKMyA1IHRpbCBjdXQgICAgICAgICAgICAgICAgICAgICAvMyA0CjIsNCw0LDYgOSB0aWwgY3V0ICAgICAgICAgICAgICAgLygyIDM7OzQgNTs2IDcgOCkKMiBlbmwgICAgICAgICAgICAgICAgICAgICAgICAgICAvKDIpCigxOzIpICAgICAgICAgICAgICAgICAgICAgICAgICAgLygxOzIpCigxOzI7KGBhYGI7My4wKSkgICAgICAgICAgICAgICAgLygxOzI7KGBhYGI7M2YpKQooMTsyOzMuMCkgMCwyIGF0eCAgICAgICAgICAgICAgIC8oMTszZikKKCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKCkKMSwyIDMsNCBjYXQgICAgICAgICAgICAgICAgICAgICAvMSAyIDMgNAoxLDIsMyw0IGNudCAgICAgICAgICAgICAgICAgICAgIC80CjEsMCwwLDEgd2VyICAgICAgICAgICAgICAgICAgICAgLzAgMwozLDAsMiB3ZXIgICAgICAgICAgICAgICAgICAgICAgIC8wIDAgMCAyIDIKMSAyIGVxbCAgICAgICAgICAgICAgICAgICAgICAgICAvMAoxLDIsMyAzLDIsMSBlcWwgICAgICAgICAgICAgICAgIC8wIDEgMAozIHRpbCBub3QgICAgICAgICAgICAgICAgICAgICAgIC8xIDAgMAoxLDIuMiwzIDMsMi4yLDEgZXFsICAgICAgICAgICAgIC8wIDEgMAoxLDIgdGlwICAgICAgICAgICAgICAgICAgICAgICAgIC8yCiJhYmMiIHRpcCAgICAgICAgICAgICAgICAgICAgICAgLzEKYGFgYmVgY2V0YSAgICAgICAgICAgICAgICAgICAgICAvYGFgYmVgY2V0YQpgYWxwaGFgYmV0YWBnYW1tYSA0LDIsMSBhdHggICAgIC9gYGdhbW1hYGJldGEKImFscGhhIiAiYmV0YSIgbXRjICAgICAgICAgICAgICAvMAoxLDIgMSwyIG10YyAgICAgICAgICAgICAgICAgICAgIC8xCigxOyJ4eSI7KGBhKSkgKDE7Inh5IjsoYGEpKSBtdGMgLzEKNCwyLDYsMiAyLDcgZm5kICAgICAgICAgICAgICAgICAvMSA0CigxOzIsMztgYWBiKSAoMiwzOzgpIGZuZCAgICAgICAgLzEgMwozLDUsOCw3IDQsOCBleGMgICAgICAgICAgICAgICAgIC8zIDUgNwoiYXpiZGMiIGdyZCAgICAgICAgICAgICAgICAgICAgIC8wIDIgNCAzIDEKMyw4LC0yLDkgZ3JkICAgICAgICAgICAgICAgICAgICAvMiAwIDEgMwoxLjIsMy4xLDMzLjIsLTFlMTAsLTEgZ3JkICAgICAgIC8zIDQgMCAxIDIKYGJldGFgYWxwaGFgemV0YSBncmQgICAgICAgICAgICAvMSAwIDIKYGFiYHh5dWBpdTJgYXMgc3J0ICAgICAgICAgICAgICAvYGFiYGFzYGl1MmB4eXUK"
var rs = "aW5pOkk6SXswOjoyODkzNjA2OTE0MTk0MTQ3ODRqOzEyODo6eDtwOjI1NjtpOjg7KGk8eCk/LygoNCppKTo6cDtwKjoyO2krOjEpO3h9IC94OjE2KDY0aykKYms6STpJSXtyOjMyLSo3K3kqST9DIHg7KHI8NCk/IDo0O3J9Cm1rOkk6SUl7dDp4IGJrIHk7aTo0KnQ7KH5JIGkpPy9pKzo0OygxMjh+aSk/ITthOkkgaTtpOjpJIGE7ajppLTQ7KGo+PTQqdCk/Lyh1OmErMTw8aj4+Mjt1OjpJIGo7ajo6dTtqLTo0KTthOjp5fHg8PDI5OyhhKzQpOjoxO2F9Cm1raTpJOkl7cjoyIG1rIDE7KHIrOCk6Ong7cn0KbWtmOkk6RntyOjMgbWsgMTsocis4KTo6eDtyfQpta2Q6STpJSXt2MjtleHQ7cjo3IG1rIDI7KHIrOCk6Ong7KHIrMTIpOjp5O3J9bWt6Okk6SUl7cjp4IG1rZCB5O3I6OjJ8Njw8Mjk7cn0KdjE6e3h0OihJIHgpPj4yOTt4bjooSSB4KSY1MzY4NzA5MTE7eHA6OCt4fXYyOnt2MTt5dDooSSB5KT4+Mjk7eW46KEkgeSkmNTM2ODcwOTExO3lwOjgreX0KZnI6MDpJe3YxO3Q6NCp4dCBiayB4bjt4OjpJIHQ7dDo6eH1keDowOkl7KHg+MjU1KT8oeHI6SSB4KzQ7KHgrNCk6OnhyLTE7KDF+eHIpPyh2MTsoeHQ+Myk/eG4vKGR4IEkgeHArNCppKTtmciB4KSl9ZHhyOntkeCB4O3J9ZHh5cjp7ZHggeDtkeCB5O3J9cng6MDpJeyh4PjI1NSk/KHgrOjQ7eDo6MStJIHgpfXJsOjA6SXt2MTt4bi8ocnggSSB4cDt4cCs6NCl9CnRpbDpJOkl7djE7KH4yfnh0KT8hO246SSB4cDtkeCB4OyhuPCcwKT8gOnRpciAtbjtzZXEoMDtuOzEpfXNlcTpJOklJSXtyOjIgbWsgeTtycDo4K3I7eS8ocnA6OnoqaSt4O3JwKzo0KTtyfXRpcjpJOkl7cjoyIG1rIHg7cnA6NCtyKzQqeDt4LyhycDo6aTtycC06NCk7cn0KZXh0Onsofnh0fnl0KT8hOygoeG5+MSkmeW4+MSk/KHg6eCB0YWtlIHluO3huOnluO3hwOngrOCk7KCh5bn4xKSZ4bj4xKT8oeTp5IHRha2UgeG47eW46eG47eXA6eSs4KTsofnhufnluKT8hfQphdHg6STpJSXt2Mjsofnl0fjIpPyE7cjp4dCBtayB5bjtycDpyKzg7eHQ/WyE7YXRjO2F0STthdEY7YXRMO2F0TDshXTtkeHlyfQphdGM6eyh5bi8oKHJwK2kpOjpDPzMyO3lpOkkgeXA7KHlpPHhuKT8ocnAraSk6OkMgeHAreWk7eXArOjQpKX0KYXRMOnsobmFzOjEgbWsgMDt5bi8ocnA6Om5hczt5aTpJIHlwOyh5aTx4bik/cnA6OkkgeHArNCp5aTtycCs6NDt5cCs6NCk7cmwgcjtkeCBuYXMpfQphdFQ6eyh5bi8ocnA6Om5hVDt5aTpJIHlwOyh5aTx4bik/cnA6OlQgeHArVyp5aTtycCs6Vzt5cCs6NCkpfW5hSTp7LTIxNDc0ODM2NDh9bmFGOns5MjIxMTIwMjM3MDQxMDkwNTYxZn0KcmV2Okk6SXt2MTsofnhuKT8gOng7eCBhdHggdGlyIHhufQpmc3Q6STpJe3YxOyh4dH43KT8ocnggMTIreDtkeCB4OyA6ZnN0IDEyK3gpO3ggYXR4IG1raSAwfQpjdXQ6STpJSXt2Mjsofnh0fjIpPyE7KHhufjEpPyhyOnkgZHJvcCBJIHhwO2R4IHg7IDpyKTtyOjUgbWsgeG47cnA6cis4O3huLyhhOkkgeHA7YjpJIHhwKzQ7KGl+eG4tMSk/Yjp5bjsoYjxhKT8hO3J4IHk7cnA6OnkgYXR4IHNlcShhO2ItYTsxKTt4cCs6NDtycCs6NCk7ZHh5cn0KZHJvcDpJOklJe3YxOyh5PnhuKT8hO3ggYXR4IHNlcSh5O3huLXk7MSl9CnJzaDpJOklJe3YyOyh+eHR+Mik/ITtuOnByb2QoeHA7eG4pO3I6eSB0YWtlIG47KHhufjEpPyhkeCB4OyA6cik7eG4tOjE7eGU6eHArNCp4bjt4bi8obTpJIHhlO246biVtO246eHAgcHJvZCB4bi1pO3I6KHNlcSgwO247bSkpY3V0IHI7eGUtOjQpO2R4cn0KcHJvZDpJOklJe3I6MTt5LyhyKjpJIHg7eCs6NCk7cn0KdGFrZTpJOklJe3YxO3I6dGlsIG1raSB5O3JwOnIrODsoeG48eSk/KHkvKHJwKzQqaSk6OmlceG4pO3ggYXR4IHJ9CnVzZTp7KH4xfkkgdis0KT8ocjp4dCBtayB4bjtycCtyKzg7bXYocnA7eHA7eG4qST9DIHh0KTtkeCB4O3g6cjt4cDp4KzgpfW12OjA6SUlJe3ovKCh4K2kpOjpDIHkraSl9CmNhdDpJOklJe3YyOygofnh0KXx+eXQpPyE7KHh0fnl0KT8gOnggdWNhdCB5Oyh4dH41KT8gOnggbGNhdCB5OyE7eH0KdWNhdDpJOklJe3YyOyh4dD40KT8ocmwgeCk7KHh0PjUpPyhyOih4KzgpbWtkIHgrMTI7ZHggeDtkeCB5OyA6cik7cjp4dCBtayB4bit5bjt3Okk/QyB4dDttdihyKzg7eHA7dyp4bik7bXYocis4K3cqeG47eXA7dyp5bik7ZHh5cn0KbGNhdDpJOklJe3YxOygoeHQgYmsgeG4pPCh4dCBiayB4bisxKSk/KHI6eHQgbWsgeG4rMTttdihyKzg7eHA7NCp4bik7ZHggeDt4OnI7eHA6eCs4KTsoeHArNCp4bik6Onk7eDo6KHhuKzEpfDU8PDI5O3h9CmVubDpJOkl7KDUgbWsgMCkgbGNhdCB4fQpjbnQ6STpJe3YxO2R4IHg7bWtpIHhufXRpcDpJOkl7djE7cjoyIG1rIDE7KDgrcik6Onh0O2R4cn0Kd2VyOkk6SXt2MTsofnh0fjIpPyE7bjowO3huLyhuKzpJIHhwO3hwKzo0KTt4cDo4K3g7cjoyIG1rIG47cnA6cis4O3huLygoSSB4cCkvKHJwOjppO3JwKzo0KTt4cCs6NCk7ZHhyfQpub3Q6STpJe3ggZXFsIG1raSAwfQplcWw6STpJSXt2MjtleHQ7eHQ/WztlcUM7O2VxRjs7ITshOyE7ZXFJXTtkeHlyfSBlcVQ6eyhyOjIgbWsgeG47cnA6cis4O3huLyhycDo6KFQgeHApflQgeXA7cnArOjQ7eHArOlc7eXArOlcpKX0KbXRjOkk6SUl7cjoyIG1rIDE7KHIrOCk6OnggbWF0Y2ggeTtkeHlyfW1hdGNoOkk6SUl7KHh+eSk/IDoxOyh+KEkgeCl+SSB5KT8gOjA7djE7eXA6eSs4O206MDt4dD9bIDoxO25uOnhuO25uOnhuPDwyO25uOnhuPDwzOyh4bi8oKH4oKEkgeHApIG1hdGNoIEkgeXApKT8gOjA7eHArOjQ7eXArOjQpOyA6MSldO25uLyh+KEMgeHAraSl+QyB5cCtpKT8gOjA7MX0KZm5kOkk6SUl7djI7KH54dH55dCk/ITtyOjIgbWsgeW47cnA6cis4O3c6ST9DIHl0O3luLyhycDo6eCBmbnggeXA7cnArOjQ7eXArOncpO2R4eXJ9Zm54Okk6SUl7djE7eHQ/WyE7IDpmbmMoeHA7eG47ST9DIHkpOyA6Zm5pKHhwO3huO0kgeSk7IDpmbmooeHA7eG47SiB5KTs7OyE7ITsgOmZubCh4cDt4bjtJIHkpXTt4fWZuYzpJOklJSXt5LygoQz96KX5DIHgraSk/IDppO3l9Zm5pOkk6SUlJe3kvKCh6fkkgeCk/IDppO3grOjQpO3l9Zm5qOkk6SUlKe3kvKCh6fkogeCk/IDppO3grOjgpO3l9Zm5sOkk6SUlJe3kvKCh6IG1hdGNoIEkgeCk/IDppO3grOjQpO3l9CmV4YzpJOklJe3I6MiBtayAxOyhyKzgpOjooSSB5KSY1MzY4NzA5MTE7cnggeDt4IGF0eCB3ZXIgciBlcWwgeSBmbmQgeH0KdXA6STpJSXt2MTsgKHh0PHkpPy94dD9bO2ljO2ZpOyA6eCBta3ogbWtmIDAuOyFdO2R4cn0gaWM6eyhyOjIgbWsgeG47cnA6OCtyO3huLyhycDo6ST9DIHhwK2k7cnArOjQpO2R4IHg7eDpyO3h0OjIpfSBmaTp7KHI6MyBtayB4bjtycDo4K3I7eG4vKHJwOjpGP0kgeHA7cnArOjg7eHArOjQpO2R4IHg7eDpyO3h0OjMpfQpzcnQ6STpJe3J4IHg7eCBhdHggZ3JkIHh9Z2RuOkk6SXtyZXYgZ3JkIHh9CmdyZDpJOkl7djE7cjpzZXEoMDt4bjsxKTt5OnNlcSgwO3huOzEpO3JwOnIrODttc3J0KHkrODtycDswO3huO3hwO3h0KTtkeHlyfQptc3J0OjA6SUlJSUlJeygoeDMteik+PTIpPyhjOih4Myt6KSUyO21zcnQoeTt4O3o7Yzt4NDt4NSk7bXNydCh5O3g7Yzt4Mzt4NDt4NSk7bXJnZSh4O3k7ejt4MztjO3g0O3g1KSl9Cm1yZ2U6MDpJSUlJSUlJe2s6ejtqOng0O3c6ST9DIHg2O2k6ejsoaTx4Myk/LyhjOms+PXg0Oyh+Yyk/JFtqPj14MztjOjA7YzooSS54NikoeDUrdypJIHgrazw8Mjt4NSt3KkkgeCtqPDwyKV07JFtjOyhhOmo7ais6MSk7KGE6aztrKzoxKV07KHkraTw8Mik6OkkgeCthPDwyO2krOjEpfQpndGM6STpJSXsoQyB4KT5DIHl9Z3RpOkk6SUl7KEkgeCk+J0kgeX1ndGY6STpJSXsoRiB4KT5GIHl9Cmd0bDpJOklJe3g6SSB4O3k6SSB5O3YyOyh+eHR+eXQpPyA6eHQ+eXQ7bjp4bjsoeW48eG4pP246eW47dzpJP0MgeHQ7bi8oYTp4cCtpKnc7Yjp5cCtpKnc7KChJLnh0KShhO2IpKT8gOjE7KChJLnh0KShiO2EpKT8gOjApO3huPnlufQoxOntndGM7Z3RpO2d0ZjtndGw7Z3RsfQoK"
function sa(s){var r=new Uint8Array(new ArrayBuffer(s.length));for(var i=0;i<s.length;i++)r[i]=s.charCodeAt(i);return r}
function pd(e){if(e){e.preventDefault();e.stopPropagation()}};
function ae(x,y,z){x.addEventListener(y,z)};
var kwasm = sa(atob(r))
var tests = atob(rt)
var src = atob(rs)
var K
// kons (k console)
var hit = kons
var konstore = ""
var edname = ""
var ed = false
function initKons() {
 kons.value = "kwasm(5796 b) 2020.03.13 tests src ini bk mk mki mkf mkd mkz til tir atx rev fst cut drop rsh prod take cat ucat lcat enl cnt tip wer not eql mtc match fnd fnx exc up srt gdn grd gtc gti gtf gtl\n "
 var hold = false
 kons.onkeydown = function(e) {
  if(e.which === 27) { // quit edit / toggle hold / close image
   delay = 0
   pd(e)
   if (ed) { qed(); hold=true }
   hold = !hold
   kons.className = (hold) ? "hold" : "term"
   imgSize(0, 0)
   hit = kons
  } else if (e.which === 13 && !hold && !ed) { // execute
   pd(e)
   var a = kons.selectionStart
   var b = kons.selectionEnd
   var s = kons.value.substring(a, b)
   if (b == a) {
    if (kons.value[a] == "\n") a -= 1
    a = kons.value.lastIndexOf("\n", a)
    if (a == -1) a = 0
    b = kons.value.indexOf("\n", b)
    if (b == -1) b = kons.value.length
    s = kons.value.substring(a, b)
   }
   if (kons.selectionEnd != kons.value.length) O(s)
   O("\n")
   s = s.trim()
   if (s === "tests")           { O(tests);                        return }
   if (s === "src")             { O(src);                          return }
   if (s === "\\c")             { kons.value=" ";imgSize(0, 0);    return }
   if (s === "\\h")             { O(atob(h));P();                  return }
   if (s.substr(0,2) === "\\e") { P();edit(s.substr(2));           return }
   if (s.substr(0,2) === "\\w") { download(s.substr(2).trim());P();return }
   if (s.substr(0,2) === "\\L") { P();loop(s.substr(2).trim());    return }
   if (s === "\\lf")            { s = "\\m #:'.fs"                        }
   hash(s);E(s);P()
  }
 }
 kons.onmousedown = function(e) { hit=kons; if(e.button==2)pd(e); }
 kons.onblur  = function(e) { kons.style.filter = "brightness(70%)" }
 kons.onfocus = function(e) { kons.style.filter = "brightness(100%)" }
}
function O(s) { kons.value += s; kons.scrollTo(0, kons.scrollHeight) }
function P()  { kons.value += " " }

function us(s) { return new TextEncoder("utf-8").encode(s) } // uint8array from string
function su(u) { return (u.length) ? new TextDecoder("utf-8").decode(u) : "" }
function kst(x) {
 var h = K.I[x>>>2]
 var t = (h>>>29)>>>0
 var n = (h&536870911)>>>0
 var o = []
 switch(t){
 case 1:
  return '"'+su(K.C.slice(8+x, 8+x+n))+'"'
 case 2:
  x >>>= 2
  return K.I.slice(2+x, 2+x+n).join(" ").split("2147483648").join("0N")
 case 3:
  x >>>= 3
  var s = K.F.slice(1+x, 1+x+n).join(" ")
  if(s.indexOf(".")==-1) s+="f"
  return s
 case 4:
  x >>>= 2
  var r = ""
  var v = K.I.slice(2+x, 2+x+n)
  var tr = function(s) { return s.substr(1, s.length-2) }
  for (var i=0; i<n; i++) r += String.fromCharCode(96) + tr(kst(v[i]))
  return r
 case 5:
  x >>>= 2
  var r = []
  for (var i=0; i<n; i++) r.push(kst(K.I[2+x+i]))
  return "("+r.join(";")+")"
 default:
  return "kst nyi: t=" + String(t)
 }
}

var funcs = {"ini":1,"bk":2,"mk":2,"mki":1,"mkf":1,"mkd":2,"mkz":2,"til":1,"tir":1,"atx":2,"rev":1,"fst":1,"cut":2,"drop":2,"rsh":2,"prod":2,"take":2,"cat":2,"ucat":2,"lcat":2,"enl":1,"cnt":1,"tip":1,"wer":1,"not":1,"eql":2,"mtc":2,"match":2,"fnd":2,"fnx":2,"exc":2,"up":2,"srt":1,"gdn":1,"grd":1,"gtc":2,"gti":2,"gtf":2,"gtl":2}
function parseNoun(s) {
 var t = 2
 if(s.startsWith('"'))                     return chrVector(s);
 if(s.startsWith(String.fromCharCode(96))) return symVector(s);
 if(s.startsWith('('))                     return lstVector(s.substr(1));
 if(s.indexOf(".") != -1) t = 3
 var v = s.split(",").map(x=>Number(x))
 var n = v.length
 if (n==0) return 0;
 var x = K.exports.mk(t, n)
 if (t==2) for (var i=0;i<n;i++) K.I[2+i+(x>>>2)] = v[i];
 else      for (var i=0;i<n;i++) K.F[1+i+(x>>>3)] = v[i];
 return x
}
function chrVector(s) {
 s = s.substr(1,s.length-2)
 var n = s.length
 var x = K.exports.mk(1, n)
 for (var i=0;i<n;i++) K.C[8+x+i] = s.charCodeAt(i);
 return x
}
function symVector(s) {
 var v = s.substr(1).split(String.fromCharCode(96))
 var x = K.exports.mk(4, v.length)
 for (var i=0; i<v.length; i++) K.I[2+i+(x>>>2)] = chrVector("_"+v[i]+"_")
 return x
}
function lstVector(s) {
 if (s.length == 0 || s.endsWith(')') == false) { throw new Error("parse list: "+s) }
 if (s.length == 1) return K.exports.mk(5, 0);
 s = s.substr(0, s.length-1)
 var a = 0
 var l = 0
 var r = []
 for (var i=0; i<s.length; i++) {
  var c = s[i]
  if (c == '(') l++
  else if (c == ')') { l--; if(l<0) throw new Error("list)") }
  else if ((l==0) && (c==';')) {
   r.push(parseNoun(s.substring(a,i)))
   a = i + 1
  }
 }
 r.push(parseNoun(s.substr(a)))
 var x = K.exports.mk(5, r.length)
 for (var i=0; i<r.length; i++) K.I[2+i+(x>>>2)] = r[i]
 return x
}
function xx(x) { return x.toString(16).padStart(8,'0') }
function dump(x, n) {
 var p = x >>> 2
 O("\n"+xx(p)+" ")
 for (var i=0; i<n; i++) {
  O(" "+xx(K.I[p+i]))
  if ((i>0)&&((i+1)%8==0)) O("\n"+xx(x+4*i+4)+" ")
  else if ((i>0)&&((i+1)%4==0)) O(" ")
 }
 O("\n")
}
function E(s) {
 try{ // todo save/restore
  var stack = []
  var v = s.split(" ").filter(x => x)
  for (var i=0; i<v.length; i++) {
   s = v[i]
   if (s=="dump") { dump(0,100); continue; }
   if(s in funcs) {
    var n = funcs[s]
    x = stack.pop()
    if(n==2) {
     y = x
     x = stack.pop()
     stack.push(K.exports[s](x, y))
    } else {
     stack.push(K.exports[s](x))
    }
    continue
   }
   var x = parseNoun(s)
   if (x!=0) { stack.push(x); continue; }
   else      { throw new Error(s); }
  }
  if(stack.length != 1) { throw new Error("stack length "+String(stack.length)) }
  else {
   x = stack.pop()
   O(kst(x)+"\n")
   K.exports.dx(x)
  }
 } catch(e) {
  console.log(e)
  O("error")
 }
}

function edit(name) { 
 edname = name; ed = true; konstore = kons.value; 
 var u = getfile(name.trim())
 kons.value = (u.length>0) ? su(u) : ""
 kons.className = "edit"
 kons.scrollTo(0,0);
}
function qed() { // quit edit
 putfile(edname, us(kons.value))
 kons.value = konstore; kons.scrollTo(0, kons.scrollHeight)
 ed = false
}
ae(kons,"contextmenu", function(e) { // button-3 search
 var l = kons.selectionEnd-kons.selectionStart; if(e.button==2&l>0) {
  pd(e); var t = kons.value.substring(kons.selectionStart,kons.selectionEnd)
  var f = function(a){ return kons.value.indexOf(t,a) }; var n = f(kons.selectionEnd)
  if (n<0){n=f(0)}; kons.setSelectionRange(n,n+l); }
})
function hash(s){window.location.hash=encodeURIComponent(s.trim())}

(async () => {
 initKons()
 const module = await WebAssembly.compile(kwasm.buffer);
 K = await WebAssembly.instantiate(module);
 K.C = new Uint8Array(K.exports.mem.buffer)
 K.I = new Uint32Array(K.exports.mem.buffer)
 K.F = new Float64Array(K.exports.mem.buffer)
 K.exports.ini(16);
 var h = decodeURIComponent(window.location.hash.substr(1))
 window.location.hash = h
 if (h.length > 0) {
  var p = kons.value.length
  kons.value += h
  kons.setSelectionRange(p, kons.value.length)
 }
 kons.focus()
})();
</script></body></html>
