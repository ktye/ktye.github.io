<html>
<head><meta charset="utf-8"><title>w</title></head>
<link rel='icon' type'image/png' href="k32.png">
<style>
 html,body,textarea{height:100%;margin:0;padding:0;overflow:hidden;}
 #kons{top:0;left:0;width:100%;height:100%;position:absolute;border:0pt;resize:none;font-family:monospace;overflow:auto;}
 .term{background:black;color:white}
 .hold{background:white;color:black}
 .edit{background:#ffffea;color:black}
 #cnv{width:100;height:100;top:0;right:0;position:absolute;}
 #dl{display:none;}
</style>
<body>
<textarea id="kons" class="term" wrap="off" autofocus spellcheck="false"></textarea>
<canvas id="cnv"></canvas>
<script>
var r = "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QCAJIAs2AgAgBygCACEKIAogA0kEQCAJIARBBCAKbGooAgA2AgALIAlBBGohCSAHQQRqIQcgDEEBaiIMIAZJDQALCyAIEAogCxAIDAELAAwACyAAEAggARAIIAgLXwEGfyAAKAIAQR12IQIgACgCAEH/////AXEhA0EIIABqIQQgASgCAEEddiEFIAEoAgBB/////wFxIQZBCCABaiEHIAJBAkZFBEAgAA8LIANBAUYEQCAAIAEQEQ8LIAELjAEBCn8gACgCAEEddiECIAAoAgBB/////wFxIQNBCCAAaiEEIAEoAgBBHXYhBSABKAIAQf////8BcSEGQQggAWohByAEKAIAIQggABALIQkgCUEIaiEKIAYgCEkEQCAIBEBBACELA0AgCkEEIAtsaiALIAZwNgIAIAtBAWoiCyAISQ0ACwsLIAEgCRAPCywBAX8gAgRAQQAhAwNAIAAgA2ogASADai0AADoAACADQQFqIgMgAkkNAAsLC24BBn8gACgCAEEddiECIAAoAgBB/////wFxIQNBCCAAaiEEIAEoAgBBHXYhBSABKAIAQf////8BcSEGQQggAWohByACRSAFRXIEQAALIAIgBUYEQCAAIAEQFA8LIAJBBUYEQCAAIAEQFQ8LACAAC60BAQh/IAAoAgBBHXYhAiAAKAIAQf////8BcSEDQQggAGohBCABKAIAQR12IQUgASgCAEH/////AXEhBkEIIAFqIQcgAkEESwRAIAAQCgsgAkEFSwRAIABBCGogAEEMahAFIQggABAIIAEQCCAIDwsgAiADIAZqEAIhCCACLQAAIQkgCEEIaiAEIAkgA2wQEiAIQQggCSADbGpqIAcgCSAGbBASIAAQCCABEAggCAt9AQR/IAAoAgBBHXYhAiAAKAIAQf////8BcSEDQQggAGohBCACIAMQASACIANBAWoQAUkEQCACIANBAWoQAiEFIAVBCGogBEEEIANsEBIgABAIIAUhACAAQQhqIQQLIARBBCADbGogATYCACAAIANBAWpBBUEddHI2AgAgAAsMAEEFQQAQAiAAEBULKwEDfyAAKAIAQR12IQEgACgCAEH/////AXEhAkEIIABqIQMgABAIIAIQAws7AQR/IAAoAgBBHXYhASAAKAIAQf////8BcSECQQggAGohA0ECQQEQAiEEQQggBGogATYCACAAEAggBAvAAQEJfyAAKAIAQR12IQEgACgCAEH/////AXEhAkEIIABqIQMgAUECRkUEQAALQQAhBCACBEBBACEHA0AgBCADKAIAaiEEIANBBGohAyAHQQFqIgcgAkkNAAsLQQggAGohA0ECIAQQAiEFIAVBCGohBiACBEBBACEHA0AgAygCACIIBEBBACEJA0AgBiAHNgIAIAZBBGohBiAJQQFqIgkgCEkNAAsLIANBBGohAyAHQQFqIgcgAkkNAAsLIAAQCCAFCwoAIABBABADEBsLygMBCX8gACgCAEEddiECIAAoAgBB/////wFxIQNBCCAAaiEEIAEoAgBBHXYhBSABKAIAQf////8BcSEGQQggAWohByACIAVGRQRAAAsgA0EBRiAGQQFLcQRAIAYQAyAAEBEhACAGIQMgAEEIaiEECyAGQQFGIANBAUtxBEAgAxADIAEQESEBIAMhBiABQQhqIQcLIAMgBkZFBEAACwJAAkACQAJAAkACQAJAAkACQAJAIAIOCAABAgMEBQYHCAsMBwtBAiADEAIhCCAIQQhqIQkgAwRAQQAhCgNAIAkgBC0AACAHLQAARjYCACAJQQRqIQkgBEEBaiEEIAdBAWohByAKQQFqIgogA0kNAAsLDAcLDAULQQIgAxACIQggCEEIaiEJIAMEQEEAIQoDQCAJIAQrAwAgBysDAGE2AgAgCUEEaiEJIARBCGohBCAHQQhqIQcgCkEBaiIKIANJDQALCwwFCwwDCwAMAwsADAILAAwBC0ECIAMQAiEIIAhBCGohCSADBEBBACEKA0AgCSAEKAIAIAcoAgBGNgIAIAlBBGohCSAEQQRqIQQgB0EEaiEHIApBAWoiCiADSQ0ACwsMAAsgABAIIAEQCCAIC4ICAQZ/IAAoAgBBHXYhAiAAKAIAQf////8BcSEDQQggAGohBAJAA0AgAiABSUUNAQJAAkACQAJAAkACQCACDgQAAQIDBAsMAwtBAiADEAIhBUEIIAVqIQYgAwRAQQAhBwNAIAYgBCAHai0AADYCACAGQQRqIQYgB0EBaiIHIANJDQALCyAAEAggBSEAQQIhAgwDC0EDIAMQAiEFQQggBWohBiADBEBBACEHA0AgBiAEKAIAuDkDACAGQQhqIQYgBEEEaiEEIAdBAWoiByADSQ0ACwsgABAIIAUhAEEDIQIMAgsgAEQAAAAAAAAAABAEEAYPDAELAAwACwwACwsgABAIIAUL"
var rt = "NSBta2kgICAgICAgICAgICAgICAgICAgICAgICAvNQo1IG1raSB0aWwgICAgICAgICAgICAgICAgICAgIC8wIDEgMiAzIDQKNSBta2kgdGlsIHJldiAgICAgICAgICAgICAgICAvNCAzIDIgMSAwCiJhYmNkIiAgICAgICAgICAgICAgICAgICAgICAgLyJhYmNkIgoiYWJjZCIgcmV2ICAgICAgICAgICAgICAgICAgIC8iZGNiYSIKMSwyLDMgICAgICAgICAgICAgICAgICAgICAgICAvMSAyIDMKMSwyLiwzICAgICAgICAgICAgICAgICAgICAgICAvMSAyIDNmCjQsNSwzLDIgcmV2ICAgICAgICAgICAgICAgICAgLzIgMyA1IDQKNCw1LDMsMiAgMSwzIGF0eCAgICAgICAgICAgICAvNSAyCjQsNSwzLDIuIDEsMyBhdHggICAgICAgICAgICAgLzUgMmYKNSBta2kgdGlsIHJldiAzIG1raSB0aWwgYXR4ICAvNCAzIDIKMyBta2kgdGlsIHJldiA1IG1raSB0aWwgYXR4ICAvMiAxIDAgME4gME4KImFiYyIgNCBta2kgdGlsIGF0eCAgICAgICAgICAvImFiYyAiCjUgbWtpIHRpbCByZXYgZnN0ICAgICAgICAgICAgLzQKMyBta2kgNSBta2kgdGlsIHJzaCAgICAgICAgICAvMCAxIDIKNSBta2kgMyBta2kgdGlsIHRhayAgICAgICAgICAvMCAxIDIgMCAxCjIgbWtpIGVubCAgICAgICAgICAgICAgICAgICAgLygyKQo1IDAgbWsgMSBta2kgY2F0IDIgbWtpIGNhdCAgIC8oMTsyKQoxLDIgMyw0IGNhdCAgICAgICAgICAgICAgICAgIC8xIDIgMyA0CjEsMiwzLDQgY250ICAgICAgICAgICAgICAgICAgLzQKMSwwLDAsMSB3ZXIgICAgICAgICAgICAgICAgICAvMCAzCjMsMCwyIHdlciAgICAgICAgICAgICAgICAgICAgLzAgMCAwIDIgMgoxIG1raSAyIG1raSBlcWwgICAgICAgICAgICAgIC8wCjEsMiwzIDMsMiwxIGVxbCAgICAgICAgICAgICAgLzAgMSAwCjMgbWtpIHRpbCBub3QgICAgICAgICAgICAgICAgLzEgMCAwCjEsMi4yLDMgMywyLjIsMSBlcWwgICAgICAgICAgLzAgMSAwCjEsMiB0aXAgICAgICAgICAgICAgICAgICAgICAgLzIKImFiYyIgdGlwICAgICAgICAgICAgICAgICAgICAvMQpgYWBiZWBjZXRhICAgICAgICAgICAgICAgICAgIC9gYWBiZWBjZXRhCmBhbHBoYWBiZXRhYGdhbW1hIDQsMiwxIGF0eCAgL2BgZ2FtbWFgYmV0YQo="
var rs = "aW5pOkk6SXswOjoyODkzNjA2OTE0MTk0MTQ3ODRqOzEyODo6eDtwOjI1NjtpOjg7KGk8eCk/LygoNCppKTo6cDtwKjoyO2krOjEpO3h9IC94OjE2KDY0aykKYms6STpJSXtyOjMyLSo3K3kqST9DIHg7KHI8NCk/IDo0O3J9Cm1rOkk6SUl7dDp4IGJrIHk7aTo0KnQ7KH5JIGkpPy9pKzo0OygxMjh+aSk/ITthOkkgaTtpOjpJIGE7ajppLTQ7KGo+PTQqdCk/Lyh1OmErMTw8aj4+Mjt1OjpJIGo7ajo6dTtqLTo0KTthOjp5fHg8PDI5OyhhKzQpOjoxO2F9Cm1raTpJOkl7cjoyIG1rIDE7KHIrOCk6Ong7cn0KbWtmOkk6RntyOjMgbWsgMTsocis4KTo6eDtyfQpta2Q6STpJSXt2MjtleHQ7cjo3IG1rIDI7KHIrOCk6Ong7KHIrMTIpOjp5O3J9bWt6Okk6SUl7cjp4IG1rZCB5O3I6OjJ8Njw8Mjk7cn0KdjE6e3h0OihJIHgpPj4yOTt4bjooSSB4KSY1MzY4NzA5MTE7eHA6OCt4fXYyOnt2MTt5dDooSSB5KT4+Mjk7eW46KEkgeSkmNTM2ODcwOTExO3lwOjgreX0KZnI6MDpJe3YxO3Q6NCp4dCBiayB4bjt4OjpJIHQ7dDo6eH1keDowOkl7KHg+MjU1KT8oeHI6SSB4KzQ7KHgrNCk6OnhyLTE7KDF+eHIpPyh2MTsoeHQ+Myk/eG4vKGR4IEkgeHArNCppKTtmciB4KSl9ZHhyOntkeCB4O3J9ZHh5cjp7ZHggeDtkeCB5O3J9cng6MDpJeyh4PjI1NSk/KHgrOjQ7eDo6MStJIHgpfXJsOjA6SXt2MTt4bi8ocnggSSB4cDt4cCs6NCl9CnRpbDpJOkl7djE7KH4yfnh0KT8hO246SSB4cDtkeCB4OyhuPCcwKT8gOnRpciAtbjtyOnh0IG1rIG47cnA6OCtyO24vKHJwOjppO3JwKzo0KTtyfXRpcjpJOkl7cjoyIG1rIHg7cnA6NCtyKzQqeDt4LyhycDo6aTtycC06NCk7cn0KZXh0Onsofnh0fnl0KT8hOygoeG5+MSkmeW4+MSk/KHg6KG1raSB5bikgdGFrIHg7eG46eW47eHA6eCs4KTsoKHlufjEpJnhuPjEpPyh5Oihta2kgeG4pIHRhayB5O3luOnhuO3lwOnkrOCk7KH54bn55bik/IX0KcmV2Okk6SXt2MTsofnhuKT8gOng7eCBhdHggdGlyIHhufQpmc3Q6STpJe3YxOyh4dH43KT8ocnggMTIreDtkeCB4OyA6ZnN0IDEyK3gpO3ggYXR4IG1raSAwfQphdHg6STpJSXt2MjsoeHR+Nyk/ITsofnl0fjIpPyE7cjp4dCBtayB5bjtycDpyKzg7eHQ/WyE7YXRjO2F0STthdEY7YXRMOyFdO2R4eXJ9CmF0Yzp7KHluLygocnAraSk6OkM/MzI7eWk6SSB5cDsoeWk8eG4pPyhycCtpKTo6QyB4cCt5aTt5cCs6NCkpfQphdEw6eyhuYXM6MSBtayAwO3luLyhycDo6bmFzO3lpOkkgeXA7KHlpPHhuKT9ycDo6SSB4cCs0KnlpO3JwKzo0O3lwKzo0KTtybCByO2R4IG5hcyl9CmF0VDp7KHluLyhycDo6bmFUO3lpOkkgeXA7KHlpPHhuKT9ycDo6VCB4cCtXKnlpO3JwKzpXO3lwKzo0KSl9bmFJOnstMjE0NzQ4MzY0OH1uYUY6ezkyMjExMjAyMzcwNDEwOTA1NjFmfQpyc2g6STpJSXt2Mjsofnh0fjIpPyA6eDsoeG5+MSk/IDp4IHRhayB5O3l9IC9ueWkgcnNoCnRhazpJOklJe3YyO246SSB4cDtyOnRpbCB4O3JwOnIrODsoeW48bik/KG4vKHJwKzQqaSk6OmlceW4pO3kgYXR4IHJ9CnVzZTp7KH4xfkkgdis0KT8ocjp4dCBtayB4bjtycCtyKzg7bXYocnA7eHA7eG4qST9DIHh0KTtkeCB4O3g6cjt4cDp4KzgpfW12OjA6SUlJe3ovKCh4K2kpOjpDIHkraSl9CmNhdDpJOklJe3YyOygofnh0KXx+eXQpPyE7KHh0fnl0KT8gOnggdWNhdCB5Oyh4dH41KT8gOnggbGNhdCB5OyE7eH0KdWNhdDpJOklJe3YyOyh4dD40KT8ocmwgeCk7KHh0PjUpPyhyOih4KzgpbWtkIHgrMTI7ZHggeDtkeCB5OyA6cik7cjp4dCBtayB4bit5bjt3Okk/QyB4dDttdihyKzg7eHA7dyp4bik7bXYocis4K3cqeG47eXA7dyp5bik7ZHh5cn0KbGNhdDpJOklJe3YxOygoeHQgYmsgeG4pPCh4dCBiayB4bisxKSk/KHI6eHQgbWsgeG4rMTttdihyKzg7eHA7NCp4bik7ZHggeDt4OnI7eHA6eCs4KTsoeHArNCp4bik6Onk7eDo6KHhuKzEpfDU8PDI5O3h9CmVubDpJOkl7KDUgbWsgMCkgbGNhdCB4fQpjbnQ6STpJe3YxO2R4IHg7bWtpIHhufXRpcDpJOkl7djE7cjoyIG1rIDE7KDgrcik6Onh0O2R4cn0Kd2VyOkk6SXt2MTsofnh0fjIpPyE7bjowO3huLyhuKzpJIHhwO3hwKzo0KTt4cDo4K3g7cjoyIG1rIG47cnA6cis4O3huLygoSSB4cCkvKHJwOjppO3JwKzo0KTt4cCs6NCk7ZHhyfQpub3Q6STpJe3ggZXFsIG1raSAwfQplcWw6STpJSXt2MjtleHQ7eHQ/WztlcUM7O2VxRjs7ITshOyE7ZXFJXTtkeHlyfSBlcVQ6eyhyOjIgbWsgeG47cnA6cis4O3huLyhycDo6KFQgeHApflQgeXA7cnArOjQ7eHArOlc7eXArOlcpKX0KdXA6STpJSXt2MTsgKHh0PHkpPy94dD9bO2ljO2ZpOyA6eCBta3ogbWtmIDAuOyFdO2R4cn0gaWM6eyhyOjIgbWsgeG47cnA6OCtyO3huLyhycDo6ST9DIHhwK2k7cnArOjQpO2R4IHg7eDpyO3h0OjIpfSBmaTp7KHI6MyBtayB4bjtycDo4K3I7eG4vKHJwOjpGP0kgeHA7cnArOjg7eHArOjQpO2R4IHg7eDpyO3h0OjMpfQoK"
function sa(s){var r=new Uint8Array(new ArrayBuffer(s.length));for(var i=0;i<s.length;i++)r[i]=s.charCodeAt(i);return r}
function pd(e){if(e){e.preventDefault();e.stopPropagation()}};
function ae(x,y,z){x.addEventListener(y,z)};
var kwasm = sa(atob(r))
var tests = atob(rt)
var src = atob(rs)
var K
// kons (k console)
var hit = kons
var konstore = ""
var edname = ""
var ed = false
function initKons() {
 kons.value = "kwasm(3630 b) 2020.03.10 tests src ini bk mk mki mkf mkd mkz til tir rev fst atx rsh tak cat ucat lcat enl cnt tip wer not eql up\n "
 var hold = false
 kons.onkeydown = function(e) {
  if(e.which === 27) { // quit edit / toggle hold / close image
   delay = 0
   pd(e)
   if (ed) { qed(); hold=true }
   hold = !hold
   kons.className = (hold) ? "hold" : "term"
   imgSize(0, 0)
   hit = kons
  } else if (e.which === 13 && !hold && !ed) { // execute
   pd(e)
   var a = kons.selectionStart
   var b = kons.selectionEnd
   var s = kons.value.substring(a, b)
   if (b == a) {
    if (kons.value[a] == "\n") a -= 1
    a = kons.value.lastIndexOf("\n", a)
    if (a == -1) a = 0
    b = kons.value.indexOf("\n", b)
    if (b == -1) b = kons.value.length
    s = kons.value.substring(a, b)
   }
   if (kons.selectionEnd != kons.value.length) O(s)
   O("\n")
   s = s.trim()
   if (s === "tests")           { O(tests);                        return }
   if (s === "src")             { O(src);                          return }
   if (s === "\\c")             { kons.value=" ";imgSize(0, 0);    return }
   if (s === "\\h")             { O(atob(h));P();                  return }
   if (s.substr(0,2) === "\\e") { P();edit(s.substr(2));           return }
   if (s.substr(0,2) === "\\w") { download(s.substr(2).trim());P();return }
   if (s.substr(0,2) === "\\L") { P();loop(s.substr(2).trim());    return }
   if (s === "\\lf")            { s = "\\m #:'.fs"                        }
   hash(s);E(s);P()
  }
 }
 kons.onmousedown = function(e) { hit=kons; if(e.button==2)pd(e); }
 kons.onblur  = function(e) { kons.style.filter = "brightness(70%)" }
 kons.onfocus = function(e) { kons.style.filter = "brightness(100%)" }
}
function O(s) { kons.value += s; kons.scrollTo(0, kons.scrollHeight) }
function P()  { kons.value += " " }

function us(s) { return new TextEncoder("utf-8").encode(s) } // uint8array from string
function su(u) { return (u.length) ? new TextDecoder("utf-8").decode(u) : "" }
function kst(x) {
 console.log("kst", x)
 var h = K.I[x>>>2]
 var t = (h>>>29)>>>0
 var n = (h&536870911)>>>0
 var o = []
 switch(t){
 case 1:
  return '"'+su(K.C.slice(8+x, 8+x+n))+'"'
 case 2:
  x >>>= 2
  return K.I.slice(2+x, 2+x+n).join(" ").split("2147483648").join("0N")
 case 3:
  x >>>= 3
  var s = K.F.slice(1+x, 1+x+n).join(" ")
  if(s.indexOf(".")==-1) s+="f"
  return s
 case 4:
  x >>>= 2
  var r = ""
  var v = K.I.slice(2+x, 2+x+n)
  var tr = function(s) { return s.substr(1, s.length-2) }
  for (var i=0; i<n; i++) r += String.fromCharCode(96) + tr(kst(v[i]))
  return r
 case 5:
  x >>>= 2
  var r = []
  for (var i=0; i<n; i++) r.push(kst(K.I[2+x+i]))
  return "("+r.join(";")+")"
 default:
  return "kst nyi: t=" + String(t)
 }
}

var funcs = {"ini":1,"bk":2,"mk":2,"mki":1,"mkf":1,"mkd":2,"mkz":2,"til":1,"tir":1,"rev":1,"fst":1,"atx":2,"rsh":2,"tak":2,"cat":2,"ucat":2,"lcat":2,"enl":1,"cnt":1,"tip":1,"wer":1,"not":1,"eql":2,"up":2}
function vector(s) {
 var t = 2
 if(s.indexOf(".") != -1) t = 3
 if(s.indexOf(",")==-1)   return 0
 if(s.startsWith(","))    s=s.substr(1)
 if(s.endsWith(","))      s=s.substr(0,s.length-1)
 var v = s.split(",").map(x=>Number(x))
 var n = v.length
 var x = K.exports.mk(t, n)
 if (t==2) for (var i=0;i<n;i++) K.I[2+i+(x>>>2)] = v[i];
 else      for (var i=0;i<n;i++) K.F[1+i+(x>>>3)] = v[i];
 return x
}
function chrVector(s) {
 s = s.substr(1,s.length-2)
 var n = s.length
 var x = K.exports.mk(1, n)
 for (var i=0;i<n;i++) K.C[8+x+i] = s.charCodeAt(i);
 return x
}
function symVector(s) {
 var v = s.substr(1).split(String.fromCharCode(96))
 var x = K.exports.mk(4, v.length)
 for (var i=0; i<v.length; i++) K.I[2+i+(x>>>2)] = chrVector("_"+v[i]+"_")
 return x
}
function xx(x) { return x.toString(16).padStart(8,'0') }
function dump(x, n) {
 var p = x >>> 2
 O("\n"+xx(p)+" ")
 for (var i=0; i<n; i++) {
  O(" "+xx(K.I[p+i]))
  if ((i>0)&&((i+1)%8==0)) O("\n"+xx(x+4*i+4)+" ")
  else if ((i>0)&&((i+1)%4==0)) O(" ")
 }
 O("\n")
}
function E(s) {
 try{ // todo save/restore
  var stack = []
  var v = s.split(" ").filter(x => x)
  for (var i=0; i<v.length; i++) {
   s = v[i]
   var x = vector(s)
   if (x!=0) { stack.push(x); continue; }
   if (s.startsWith('"')) { stack.push(chrVector(s)); continue; }
   if (s.startsWith(String.fromCharCode(96))) { stack.push(symVector(s)); continue; }
   var x = Number(s)
   var y = 0
   if(x==x) {
    stack.push(x)
   } else if (s=="dump") {
    y = stack.pop()
    dump(stack.pop(), y)
   } else if(s in funcs) {
    var n = funcs[s]
    x = stack.pop()
    if(n==2) {
     y = x
     x = stack.pop()
     stack.push(K.exports[s](x, y))
     stack[stack.length-1]
    } else {
     stack.push(K.exports[s](x))
    }
   }
  }
  if(stack.length == 1) {
   x = stack[stack.length-1]
   O(kst(x)+"\n")
   K.exports.dx(x)
  }
 } catch(e) {
   O("error")
 }
}

function edit(name) { 
 edname = name; ed = true; konstore = kons.value; 
 var u = getfile(name.trim())
 kons.value = (u.length>0) ? su(u) : ""
 kons.className = "edit"
 kons.scrollTo(0,0);
}
function qed() { // quit edit
 putfile(edname, us(kons.value))
 kons.value = konstore; kons.scrollTo(0, kons.scrollHeight)
 ed = false
}
ae(kons,"contextmenu", function(e) { // button-3 search
 var l = kons.selectionEnd-kons.selectionStart; if(e.button==2&l>0) {
  pd(e); var t = kons.value.substring(kons.selectionStart,kons.selectionEnd)
  var f = function(a){ return kons.value.indexOf(t,a) }; var n = f(kons.selectionEnd)
  if (n<0){n=f(0)}; kons.setSelectionRange(n,n+l); }
})
function hash(s){window.location.hash=encodeURIComponent(s.trim())}

(async () => {
 initKons()
 const module = await WebAssembly.compile(kwasm.buffer);
 K = await WebAssembly.instantiate(module);
 K.C = new Uint8Array(K.exports.mem.buffer)
 K.I = new Uint32Array(K.exports.mem.buffer)
 K.F = new Float64Array(K.exports.mem.buffer)
 K.exports.ini(16);
 var h = decodeURIComponent(window.location.hash.substr(1))
 window.location.hash = h
 if (h.length > 0) {
  var p = kons.value.length
  kons.value += h
  kons.setSelectionRange(p, kons.value.length)
 }
 kons.focus()
})();
</script></body></html>
