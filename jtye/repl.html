<!DOCTYPE html>
<head><meta charset="utf-8">
<link rel=icon href="../kelas16.png">
<title>jtye</title>
<style>
*{font-family:monospace;margin:0}
._{height:calc(100vh - 1em);width:calc(100vw - 1em);padding:.5em;outline:none}
</style>


<script src="k.js"></script>
<script src="parse.js"></script>

<script>
let
o=x=>$.textContent+=x,
krep=s=>{
 if(s.trim().startsWith("\\")){$.textContent+="\n ";$.style.display="none";main.style.display="block";return}
 let p=parse(s);o("  //"+p+"\n")
 try{
  r=string(eval(p))
  o(r+"\n ")
 }catch(e){
  o(" ^"+e+"\n ")
 }
 end()},
end=()=>{
 let s=window.getSelection()
 s.removeAllRanges()
 let r=document.createRange()
 r.selectNodeContents($)
 r.collapse(false)
 s.addRange(r)
 window.scrollTo(0,$.scrollHeight)
 $.focus()},
pos=()=>getSelection().getRangeAt(0).endOffset


window.onkeydown=e=>{if(e.key=="Enter"){
 e.preventDefault() 
 let o=pos(),t=$.textContent,j=t.indexOf("\n",o),k=t.indexOf(" //",o)
 if(j>=0)o=j;if(k>=0)o=Math.min(o,k-1)
 $.textContent=t=t.slice(0,o)
 let i=t.lastIndexOf("\n")
 t=t.slice(i>0?1+i:0)
 if(t.trim()!=""){krep(t)}}}

</script>
</head>


<pre id="$" class="_" contenteditable="true" spellcheck="false">jtye/k
 
</pre>
</body></html>
