<!DOCTYPE html>
<head><meta charset="utf-8"><title>cdc 6600</title>
<rel="icon" type="image/png" sizes="32x32" href="../db/kelas32.png">
<style>
@font-face{font-family:'AVHersheySimplexHeavy';src:url(./AVHersheySimplexHeavy.woff2) format('woff2');}
*{font-family:'AVHersheySimplexHeavy';font-size:20px;box-sizing:border-box;text-shadow:0 0 3px #00ff00;}
body{background:#020e02}
#a{background-image:url('cdc.jpg');background-size:cover;position:absolute;top:0;left:50%;margin-left:-600px;width:1200px;height:600px;}
#l{width:340px;height:330px;color:#84fa82;position:absolute;left:100px;top:150px;overflow:hidden;outline:none;border:none;resize:none;background:transparent}
#r{width:340px;height:330px;color:#84fa82;position:absolute;left:750px;top:140px;overflow:hidden;outline:none;border:none}
</style></head>

<body onload="l.value=aoc;kinit(aoc)">
<div id="a"><textarea id="l"  spellcheck="false">!100</textarea><pre id="r"></pre></div>


<script>
let ge=x=>document.getElementById(x)
const td_=new TextDecoder("utf-8"),su=x=>td_.decode(x)
const te_=new TextEncoder("utf-8"),us=x=>te_.encode(x)

let keydown=e=>{if((e.key=="Enter")&&e.shiftKey){let x=e.target.selectionStart;
 let v=ge("l").value.split("\n"),p=0
 for(let i=0;i<v.length;i++){let s=v[i];if((x>=p)&&(x<1+p+s.length)){exec(s);break};p+=1+s.length}
 return false}}
let exec=(s)=>{K.repl(KC(s));let r=ge("r");r.scrollTo(0,r.scrollHeight)}

ge("a").onclick=e=>{if("a"==e.target.id){kinit(ge("l").value)}}
ge("l").onkeydown=keydown

let /*there be*/ K
let C=()=>new Int8Array(K.memory.buffer),I=()=>new Int32Array(K.memory.buffer),J=()=>new BigInt64Array(K.memory.buffer),F=()=>new Float64Array(K.memory.buffer),lo=x=>Number(BigInt.asUintN(32,x))
let kenv={env:{ 
 Exit:  function(x      ){},
 Args:  function(       ){return 0},
 Arg:   function(x,y    ){return 0},
 Read:  function(a,b,c  ){return -1},
 Write: function(a,b,c,d){kout(su(new Uint8Array(K.memory.buffer,c,d)));return 0},
 ReadIn:function(x,y    ){return 0},
 Native:function(x,y    ){return 0}}}
function kout(s){ge("r").textContent+=s}
async function kinit(s){
 console.log("kinit")
 ge("r").textContent=""
 let kw;await fetch("../k.wasm").then(r=>r.arrayBuffer()).then(r=>kw=r)
 let r=await WebAssembly.instantiate(kw,kenv)
 K=r.instance.exports
 K.kinit()
 K.dx(K.Asn(Ks("l."),K.Atx(Ks("lxy"),K.Val(KC("44 15")))))
 if("string"==typeof s)exec(s)}

let
KT=t=>K.Atx(K.Val(KC("+!/")),K.l2(KS(t.k),KL(t.v.map((x,i)=>("i"==t.t[i])?KI(x):("f"==t.t[i])?KF(x):KS(x))))),
KC=x=>{let r=K.mk(18,x.length  );C().set(("string"===typeof x)?us(x):x,lo(r));return r},
KF=x=>{let r=K.mk(21,x.length  );F().set(x,lo(r)>>>3);return r},
KS=x=>{let r=K.mk(20,x.length);I().set(x.map(x=>lo(Ks(x))),lo(r)>>>2);return r},
KI=x=>{let r=K.mk(19,x.length);I().set(x,lo(r)>>>2);return r},
KL=x=>{let r=K.mk(23,x.length);J().set(x,lo(r)>>>3,new BigInt64Array(x));return r},
IK=x=>{let p=lo(x)>>>2,n=K.nn(x);let r=I().slice(p,p+n);K.dx(x);return r},
FK=x=>{let p=lo(x)>>>3,n=K.nn(x);let r=F().slice(p,p+n);K.dx(x);return r},
ZK=x=>{let p=lo(x)>>>3,n=K.nn(x);let r=F().slice(p,p+2*n);K.dx(x);return r},
DK=x=>{let j=J(),p=lo(x)>>>3,r=[K.rx(j[p]),K.rx(j[1+p])];K.dx(x);return r}
Ks=x=>K.sc(KC(x)),
asn=(s,y)=>K.dx(K.Asn(Ks(s),y))


let aoc=`s:"pqr3stu8vwx"
n:0+"0123456789"
+/(*;*|)@\\x(&-1<x:n?0+s)`

</script></body></html>
