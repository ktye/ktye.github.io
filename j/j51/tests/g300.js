NB. Copyright (c) 1989 1990, Roger K.W. Hui & K.E. Iverson
NB. Copyright (c) 1990-1992, Iverson Software Inc.
NB. All Rights Reserved.


NB. +/ .* ---------------------------------------------------------------

f    =. +/ .*
g    =. +/@(*"1 _)
test =. f -: g

(?2) test ?2
(?2) test ?17$2
(?2) test ?13 17$2
(?2) test ?1 2 3$2
(?17$2) test ?2
(?17$2) test ?17$2
(?17$2) test ?17 1$2
(?17$2) test ?17 2 3$2
(?17 3$2) test ?2
(?17 3$2) test ?3 17$2
(?17 3$2) test ?3 11$2
(?17 3$2) test ?3 1 1$2
(?1 7 3$2) test ?2
(?1 7 3$2) test ?3 17$2
(?1 7 3$2) test ?3 11$2
(?1 7 3$2) test ?3 1 1$2

(?3 15$2)       test ?15 7$2
(?3 15$2)       test ?15 2 7$100
(?3 15$2)       test ?15 7$1e9
(?3 15$2)       test o.?15 7 2$1100
(?3 15$2)       test r.?15 7 1 2$1100

(?3 15$100)     test ?15 2 3 1 $2
(?3 15$100)     test ?15 1 2 2$100
(?3 15$100)     test ?15 7$1e9
(?3 15$100)     test o.?15 7$1100
(?3 15$100)     test r.?15 7$1100

(?2 3 15$1e9)   test ?15 7$2
(?2 3 15$1e9)   test ?15 1 2 3$100
(?2 3 15$1e9)   test ?15 7$1e9
(?2 3 15$1e9)   test o.?15 2 3 1$1100
(?2 3 15$1e9)   test r.?15 7$1100

(o.?3 15$100)   test ?15 7$2
(o.?3 15$100)   test ?15 7$100
(o.?3 15$100)   test ?15 7$1e9
(o.?3 15$100)   test o.?15 7$1100
(o.?3 15$100)   test r.?15 7$1100

(r.?3 15$100)   test ?15 7$2
(r.?3 15$100)   test ?15 7$100
(r.?3 15$100)   test ?15 7$1e9
(r.?3 15$100)   test o.?15 7$1100
(r.?3 15$100)   test r.?15 7$1100

(?1000)         test o.?1000
(?1000)         test o.?10$1000
(r.?1000)       test ?10 2 3 1$1000
(?10$1000)      test ?10$1000
(r.?10$1000)    test o.?10 7$1000

(o.?10$1000)    test o.?1000
(?10 1 7 1$1e3) test ?2
(o.?10 7$1000)  test 7?20

(i.0)           test i.0
(i.0)           test i.0 4 5
(i.4 0)         test 5
5               test i.0 5
(i.4 0)         test i.0 5

*./, test&>/~0;1;(?1e4);(1e9+?1e9);2e9;(o.?1e6);r.?1e6

sh =. $@(+/ .*) -: }:@$@[ , }.@$@]

1         sh 2
567       sh ,7
_123      sh r.?12$100
3.4       sh o.i.1 4 5
4         sh i.0
3j4       sh i.0 0 0
(,9)      sh ,_3.45
(,9)      sh i.1 4 5 1
(,9)      sh i.1 0 0
(i.0)     sh 0
(i.0)     sh i.0
(i.0)     sh i.0 3 4 5
''        sh i.59$0
(i.3 0)   sh i.0 5
(i.3 4 0) sh 4j5
(i.3 0 0) sh i.0
(i.0 5 0) sh i.12$0
(i.4 5 1) sh o.9
(i.4 5 1) sh ,9
(i.4 5 1) sh i.1 2 0
