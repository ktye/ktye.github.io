NB. Copyright (c) 1989 1990, Roger K.W. Hui & K.E. Iverson
NB. Copyright (c) 1990-1992, Iverson Software Inc.
NB. All Rights Reserved.


NB. 5!:1 ----------------------------------------------------------------

ar  =. 5!:1
dr  =. 5!:2
nar =. <&((<,'0')&,)&<
mtv =. $0

(ar <'a') -: nar a =. 1=?10$2
(ar <'a') -: nar a =. 'Cogito, ergo sum.'
(ar <'a') -: nar a =. ?3 4$10
(ar <'a') -: nar a =. 3.14159265358979
(ar <'a') -: nar a =. ^0j1*?3 4$10
(ar <'a') -: nar a =. +&.>?10$25

(ar <'a') -: nar a =. 0 3 4 $ 1=?10$2
(ar <'a') -: nar a =. 4 0   $ 'Cogito, ergo sum.'
(ar <'a') -: nar a =. 0     $ ?3 4$10
(ar <'a') -: nar a =. 4 0 5 $ 3.14159265358979
(ar <'a') -: nar a =. 0 0   $ ^0j1*?3 4$10
(ar <'a') -: nar a =. 0 0 0 $ +&.>?10$25

(ar <'f') -: <,'^' [. f =. ^
(ar <'f') -: <'/.' [. (+ f =. /.)
(ar <'f') -: <'&.' [. (+ (f =. &.) +)

plus =. +
or   =. +.
over =. ,
hook =. (plus or) f.
fork =. (plus,or) f.
(ar <'plus') -: <,'+'
(ar <'or'  ) -: <'+.'
(ar <'over') -: <,','
(ar <'hook') -: <(,'2');<ar ;:'plus      or'
(ar <'fork') -: <(,'3');<ar ;:'plus over or'

f   =. *
a   =. ,:'*y.'
b   =. ,: 'x.*y.'
gd  =. :
fnn =. '*y.' : 'x.*y.'
fnv =. '*y.' : *
fvn =.     * : 'x.*y.'
fvv =.     * : *
(ar <'gd' ) -: <(,':')
(ar <'fnn') -: <(,':');<ar ;:'a b'
(ar <'fnv') -: <(,':');<ar ;:'a f'
(ar <'fvn') -: <(,':');<ar ;:'f b'
(ar <'fvv') -: <(,':');<ar ;:'f f'

one  =. 1
two  =. 2
a    =. ,: 'x./'
b    =. ,: 'x.&y.'
adv  =. 'x./' : 1
conj =. 'x.&y.' : 2
(ar <'adv' ) -: <(,':');<ar ;:'a one'
(ar <'conj') -: <(,':');<ar ;:'b two'

cir =. o.
t   =. '$.=.1,y.#2'; 't=.]'; 't=.x.&t f.'
pow =. t : 2
(ar <'pow') -: <(,':');<((,'0');>t);ar <'two'

f=.o. pow 0
r=.,']'
(ar <'f') -: <r

f=.o. pow 1
r=.(,'&');<(ar <'cir'),<r
(ar <'f') -: <r

f=.o. pow 2
r=.(,'&');<(ar <'cir'),<r
(ar <'f') -: <r

f=.o. pow 3
r=.(,'&');<(ar <'cir'),<r
(ar <'f') -: <r

tv  =. '(ar <''x.'') -: <,y.' : 2

=  tv '='
<  tv '<'
<. tv '<.'
<: tv '<:'
>  tv '>'
>. tv '>.'
>: tv '>:'
+  tv '+'
+. tv '+.'
+: tv '+:'
*  tv '*'
*. tv '*.'
*: tv '*:'
-  tv '-'
-. tv '-.'
-: tv '-:'
%  tv '%'
%. tv '%.'
%: tv '%:'
^  tv '^'
^. tv '^.'
$  tv '$'
~. tv '~.'
~: tv '~:'
|  tv '|'
|. tv '|.'
|: tv '|:'
,  tv ','
,. tv ',.'
,: tv ',:'
;  tv ';'
;: tv ';:'
#  tv '#'
#. tv '#.'
#: tv '#:'
/: tv '/:'
\: tv '\:'
[  tv '['
]  tv ']'
{  tv '{'
{. tv '{.'
}. tv '}.'
". tv '".'
": tv '":'
!  tv '!'
?  tv '?'
[  tv '['
]  tv ']'
A. tv 'A.'
C. tv 'C.'
E. tv 'E.'
e. tv 'e.'
i. tv 'i.'
j. tv 'j.'
o. tv 'o.'
r. tv 'r.'
0: tv '0:'
1: tv '1:'

(<,'~') -: ar <'f' [. (+f=.~ )
(<,'/') -: ar <'f' [. (+f=./ )
(<'/.') -: ar <'f' [. (+f=./.)
(<,'\') -: ar <'f' [. (+f=.\ )
(<'\.') -: ar <'f' [. (+f=.\.)
(<,'}') -: ar <'f' [. (+f=.} )

(<'^:') -: ar <'f' [. (+     (f=. ^:)+)
(<,'`') -: ar <'f' [. (+     (f=. ` )+)
(<'`:') -: ar <'f' [. ((''`+)(f=. `:)0)
(<,'.') -: ar <'f' [. (+     (f=. . )+)
(<':.') -: ar <'f' [. (+     (f=. :.)+)
(<,':') -: ar <'f' [. (+     (f=. : )+)
(<';.') -: ar <'f' [. (+     (f=.;. )1)
(<,'@') -: ar <'f' [. (+     (f=.@  )+)
(<,'"') -: ar <'f' [. (+     (f=."  )+)
(<,'&') -: ar <'f' [. (+     (f=.&  )+)
(<'&.') -: ar <'f' [. (+     (f=.&. )+)
(<'!.') -: ar <'f' [. (<     (f=.!. )0)
