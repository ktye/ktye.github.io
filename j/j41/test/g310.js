NB. Copyright (c) 1989 1990, Roger K.W. Hui & K.E. Iverson
NB. Copyright (c) 1990-1992, Iverson Software Inc.
NB. All Rights Reserved.


NB. m :v, u :n, and u :v ------------------------------------------------

p =. ?4 10$500
q =. ?4 10$50

f =. 'y.%3' : *
(q%3) -: f q
(p*q) -: p f q

f =. ^ : 'x.+y.'
(^p)  -: f p
(p+q) -: p f q

f =. %&>: : |
(%1+q) -: f q
(p|q)  -: p f q


NB. : labels ------------------------------------------------------------

nc=.4!:0

2 -: 2 ('' : t) t=.'L10)'; 'nc <''L10'''
2 -:   (t : '') t
2 -: 1 ('' : t) t=.'x=.nc <''L10'''; 'L10)'; 'x'
2 -:   (t : '') t

(i.1)  -: 1 ('' : t) t=.'L10)L10'
(i.1)  -:   (t : '') t

(i.#t) -: 1 ('' : t) t=.'L10)'; 'L10'
(i.#t) -:   (t : '') 2

(1 2 3;5j4) -: 1 ('' : t) t=.'x=.one'; 'one)'; 'one=.5j4'; 'x;one'
(1 2 3;5j4) -:   (t : '') 2


NB. : fn call nesting ---------------------------------------------------

f=.('$.=.>:0<y.'; '1'; 'f<:y.') : ''

f 14
f 15
f 30
f 60


NB. :20 -----------------------------------------------------------------

T  =. :20
ar =. 5!:1
eq =. '(ar<''x.'') -: (ar<''y.'')' : 2

(+/@] % #@]) eq ('(+/y.)%#y.'      T)
([+])        eq ('x.+y.'           T)
(([+])*[-])  eq ('(x.+y.)*(x.-y.)' T)


NB. :21 -----------------------------------------------------------------

T =. :21
A =. :1
ar =. 5!:1
eq =. '(ar<''x.'') -: (ar<''y.'')' : 2

over =. ({. ,.@; }.)@":@,
by   =. ' '&;@,.@[ ,. ]
s    =. '[ by ] over x./'
vt   =. s T
vtx  =. s A
a =. _20+?3$40
b =. _20+?4$40
a (+vt -: +vtx) b
a (-vt -: -vtx) b
a (|vt -: |vtx) b

s =. ']x.['
til  =. s T
tilx =. s A
(^til -: ^tilx) 3
2 (^til -: ^tilx) 3
(^til -: ^~) 3
2 (^til -: ^~) 3

s=. 'x.@}.~ ,.@i.@#'
sfx  =. s T
sfxx =. s A
(+/sfx -: +/sfxx) ?20$200
(+/sfx -: +/sfxx) ?20 3$200
(< sfx -: < sfxx) (?20 3$$a.){a.
(+/sfx -: +/\.) ?20 3$200
(< sfx -: < \.) (?20 3$$a.){a.

(+ s T) eq (+ s A) [. s=.'#     $      %    '
(+ s T) eq (+ s A) [. s=.'#     $      x.   '
(+ s T) eq (+ s A) [. s=.'#     e.&x.  %    '
(+ s T) eq (+ s A) [. s=.'#     x.     x.@{.'
(+ s T) eq (+ s A) [. s=.'x.&*  $      %    '
(+ s T) eq (+ s A) [. s=.'x.    $      x.   '
(+ s T) eq (+ s A) [. s=.'x.    x.     %    '
(+ s T) eq (+ s A) [. s=.'x.&e. x.     x./\ '

(+ s T) eq (+ s A) [. s=.'#     $        '
(+ s T) eq (+ s A) [. s=.'#     x.&*     '
(+ s T) eq (+ s A) [. s=.'x.@%  $        '
(+ s T) eq (+ s A) [. s=.'x.@%  +/@(x.&=)'

(+ s T) eq (+ s A) [. s=.'*  @   =  '
(+ s T) eq (+ s A) [. s=.'*./@(x.&=)'
(+ s T) eq (+ s A) [. s=.'x./@(=&|) '
(+ s T) eq (+ s A) [. s=.'x./@(=&x.)'

(+ s T) eq (+ s A) [. s=.'+/    '
(+ s T) eq (+ s A) [. s=.'x.&e.~'

a=. /(+`-`*`%`)\
b=. '+ - * % x./' T
(ar <'a') -: ar <'b'

a=. /(+`-`*`)\
b=. '+ - * x./' T
(ar <'a') -: ar <'b'

a=. /(`(+`(-*%)))\
b=. 'x./ + - * %' T
(ar <'a') -: ar <'b'

a=. /(`(+-*))\
b=. 'x./ + - *' T
(ar <'a') -: ar <'b'


NB. :22 -----------------------------------------------------------------

T  =. :22
C  =. :2
ar =. 5!:1
eq =. '(ar<''x.'') -: (ar<''y.'')' : 2

s =. 'x.@{. , y.@}.'
td  =. s T
tdx =. s C
(o.td- -: o.tdx-) ?10 4$20
(?10) (3&* td ^ -: 3&* tdx ^) ?10 4$20

s =. 'x.@(y."1 _)'
ip  =. s T
ipx =. s C
(?3 4$40) (+ /ip *  -: +/ ipx * ) ?4 5$40
(?3 4$2)  (*./ip +. -: *./ipx +.) ?4 5$2
(?3 4$40) (+ /ip *  -: + / . * ) ?4 5$40
(?3 4$40) (*./ip +. -: *./ . +.) ?4 5$40

(+ s T -) eq (+ s C -) [. s=.'#     $          x.@y.'
(+ s T -) eq (+ s C -) [. s=.'#     y.&(e.&x.) %    '
(+ s T -) eq (+ s C -) [. s=.'#     x.         y.   '
(+ s T -) eq (+ s C -) [. s=.'x.&y. $          %    '
(+ s T -) eq (+ s C -) [. s=.'y.    $          x.   '
(+ s T -) eq (+ s C -) [. s=.'x.    x.&y.      %    '
(+ s T -) eq (+ s C -) [. s=.'y.    x.         x.   '

(+ s T -) eq (+ s C -) [. s=.'#     x.&*@y.'
(+ s T -) eq (+ s C -) [. s=.'x.@y. $      '
(+ s T -) eq (+ s C -) [. s=.'x.@y. x.&y.  '

(+ s T -) eq (+ s C -) [. s=.'x.@y.'
(+ s T -) eq (+ s C -) [. s=.'e.&x.@(3&y.)'

odd  =. 'x. -:@- x.@y.' T
even =. 'x. -:@+ x.@y.' T
sinh =. 5&o. [. sh =. ^ odd  -
cosh =. 6&o. [. ch =. ^ even -
(sinh a) -: sh a=.j._50+/?2 3 4$100
(cosh a) -: ch a=.j._50+/?2 3 4$100

minors =. }."1@(1&([\.))
det    =. 'y./@,`({."1 x. .y. $:@minors)@.(1&<@{:@$)"2' T
(-/det* a) -: -/ .* a=.?3 3$1000
