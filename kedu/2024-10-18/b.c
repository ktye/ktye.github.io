_f(_E,X(b(23)&(i6)(1+Ex)))_f(E_,X((e6)(127<<23|Ix)-1))f(qs,W6(x);VA=xi;VX=xi+1;J(nx-1<<2,P(bi(*A++>Ix),0))1)
#define lmn(g,z) _Z(g,z,il,im,in,i2*a) //?= ^<>
#define B_(t) {VR=b;J(m*sizeof(t),*R++=z0)t*X=sx;$(k,$(i,j(nx,b[*X++]++))j(nx,b[*X++]=1))$(i,j(nx,((i2*)b)[*X++]++))j(nx,((i2*)b)[*X++]=1)}
#define _B(t,T) V(3,n,i2*R=ri;X=b;J(k?m:4*m,t A=T;Ua=k?bg(0<A):bi(0<A);h(nu(a),*R++=i?A[iu(a)]:(k?64*j:16*j)+iu(a);a&=a-1)))
Z0 b[1<<23];_g(b_,im=$3(tx-2,256,mi(nx,sx)+1,1<<23);ik=m>1<<21;$(3>tx,B_(i0))B_(i2)m)g(_b,i2*R=xi+nx;x)//_i(j(B[i],*--R=i))x)
g(uf,Qt(1<tx-2)im=_x(b_(i,x));ik=m>1<<21;in=0;VX=b;J(k?m:m*4,n+=nu(k?bg(0<Gx):bi(0<Ix)))Ua=m>n?V(3,n,i2*R=ri;X=b;$(k,_B(g6,Gx))_B(i6,Ix)):iz(0,m);3>tx?_t(a):a)
lmn(b1,P(20>=n|2>m,)iA=a;i2*B=b;IX=A;j(n4(n),i6 x=Ix;ii=bi(l+m/2>x);A+=c2(A,i,x);B+=c2(B,(i1)~i,x))ii=A-a;B=b;i(n-i,*A++=*B++)b1(l+m/2,m-m/2,n-i,a+i);b1(l,m/2,i,a))
g(o2,P(i-1>>23|i/16>nx,x=wz(x);b1(0,i,nx,sx);i(20,VR=xi+i%2;J(nx-i%2<<2,*R=ab(*R);++R))x)_b(b_(1,x),uz(x)))
f(s2,P(2>nx,x)Qz(5!=bx)P(18>nx,bb(wz(x)))P(qs(x),x)im=mi(nx,sx);Qz(m>>34-tx)4>tx?o2(m+1,x):E_(o2(1<<23,_E(x))))g(ie,Qz(1!=i)s2(x))
f(uq,P(ax,iz(2,x))uf(0,x))f(fq,Qr(ax)uf(1,x))f(so,P(ax,4>tx?iz(1,x):te(ex/0x1p64*PQ()[0]))s2(x))f(_s,QZ)f(s_,QZ)f(ff,QZ)
