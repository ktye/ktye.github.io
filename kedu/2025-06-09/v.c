#define J(t,x) W(j-->h)((t*)r)[i]=x
#include"v.h"//ABCD.MLGE vv mv sX RX SX DX
e(Ae,i(4,z+=S2(i,z))z[15],Ez)e(_v,Ae(r(E0,Ez[4]={};i(n/4,i(4,zi+=*Z++))i(n%4,r+=Zi)i(4,r+=zi))),in,EZ)e(vv,Ae(r(E0,Ez[4]={};i(n/4,i(4,zi+=*Y++**Z++))i(n%4,r+=Yi*Zi)i(4,r+=zi))),in,EY,EZ)
#define fo(m,T,R,g,G) u(R,i(6-m,z=G(z,S##m(i,z)))z[b(6-m)],T z)u(g,R(r(Z2,i(n,r=G(r,Zi)))),in,IZ)
fo(0,G,Ag,ag,GA)fo(0,G,Mg,mg,GM)fo(2,I,Ai,ai,IA)fo(2,I,Mi,mi,IM)u(au,ue(_v(n,Z)),in,IZ)u(sb,Ai(r(Z2,i(n,r+=SB(Zi)))),in,IZ)

V(rX,ee=1/_Q(vv(n4(n),Z,Z)/n-E0)[0];n(e*Zi),in,IR,EZ)
V(sX,ee=eu(mi(n,Z));n(E_(Zi-e))e=1/_v(n,R);n(e*Ri),in,ER,EZ)


void P_();extern int N;Zu l,m,n;ZI*r,*y,*z;u(mn,m=I;r=R;y=Y;z=Z;n=J,IJ)_ w;V(p_,$(N>1&n>=N*512,P_(_))N=r(N,N=1;_(0)),in,_ _)
Vn(v_,J(I,$8(m,GB(((U*)z)[j]),c(_z,I),IE(zj),EI(zj),(1<<31)-1&zj,ze*zj,_Q(zj),E_(zj))))
Vn(b_,J(U,b0($6(m,gy<zg,gy>zg,gy==zg,GI(iy<z_),GI(iy>z_),GI(iy==z_)))))
Vn(i_,J(I,$8(m,iy+zi,iy-zi,iy*zi,x(iy%i1*zi/i1,iy/i1?zi-iy/i1*x:x),yi+zi,yi-zi,yi*zi,AT(y,zi,2))))
Vn(e_,J(I,$9(m,ey+ze,ey-ze,ey*ze,ey/ze,ye+ze,ye-ze,ye*ze,ye/ze,ye*ze/(1+E_(-ze)))))

//+-*%&|<>=..@^^_^+*%RE ''''''''''..\\_^..%RE//+-*%&|<>=~//abcd.mlge //zzzzzz111..y466eeeeee
V_(av,n=p0((U)n<<bt,Z);19-j?p_(mn(y?3>j-6?6>t?j-6:j-3:j+4*!ty:j-12,n,R,y,Z),y?3>j-6?b_:14>t?i_:e_:v_):rX(n,R,Z),ij,it,in,IR,Uy,IZ)
Vn(a_,iR=r;Ri=w(j-h,z+h))U_(a,n=p0((U)n<<bt,Z);P(2>t,sb(n,Z))Zu r[16];w=$5(6>t?j:14>t|!j?j+2:4,mg,ag,mi,ai,au);p_(mn(0,n,r,0,Z),a_);w(1,r),ij,it,in,IZ)
Vm(mv_,J(e,vv(n,y+j*n,z)))Vn(vm_,ER=r+h*n;eY=y;EZ=z+h*n;iI=j-h;i(I/4,Ez[4]={};i(m,j(4,zj+=Yi*Zj)Z+=n)j(4,*R++=zj)Z-=m*n-4)i(I%4,Ri=r(E0,i(m,r+=Yi*Z[n*i])++Z)))
V_(mv,p_(I*mn(I,p0(32*J,Z),R,Y,Z),mv_),IJ)V_(vm,p_(I*mn(I,J/16,R,Y,Z),vm_),IJ)V(m6,i(3+I>>2,j(4,Ez[4]={};h(64,k(4,z[k]+=Y[64*(4*i+k)+h]*Z[4*h+j]))k(4,R[4*(4*i+k)+j]+=z[k]))),iI,ER,eY,EZ)
Vm(mm_,ER=r+h*n;eY=(e*)y+h*l;EZ=z;im=j-h;i(m*n,Ri=Z0)k(l/64,j(n/4,m6(m,Y+l*64+k,R+n*4+j,Z+n*l*(64+k)+j))))
V_(mm,J/=16;$((U)H*I*J-1>>12,p_((l=H)*I*mn(I,J,R,Y,Z),mm_))i(3+I>>2,j(J,Ez[4]={};h(H,k(4,z[k]+=Y[H*(4*i+k)+h]*Z[J*h+j]))k(4,R[J*(4*i+k)+j]=z[k]))),iH,IJ)

//todo
V_(r0,N(6,R0(*--Z)),in,IR,IZ)V_(r2,N(4,R2(*--Z)),in,IR,IZ)V_(n0,N(4,JJ()),in,IR)V_(n1,N(4,I2|16*i),in,IR)V_(nx,N(9,m-Z2),Un,IR,im)
#define mM(n,i) ik=1<<i;h(1<<6-n-1-i,j(k,ii=2*h*k+j;zi=l##n(zi,r(zk,zk=h##n(zi,r)))))
V_(t0,i(I>>6,j(J>>6,Gz[1<<6];i(1<<6,zi=Zi)i(6,mM(0,i))i(1<<6,Ri=zi))),IJ)V_(t2,i(I>>4,j(J>>4,Gz[1<<4];i(1<<4,zi=Zi)i(4,mM(2,i))i(1<<4,Ri=zi))),IJ)
