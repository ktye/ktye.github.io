#define N2(z) i(n2(n),Ri=z)
#include"v.b"//reduce(MS) mv vm mm atomic(+-* <>=) uniform(+|\QR) AZ(a*~r x+.y)
V2(jj,JJ(),in,ER)V2(nn,I2|16*i,in,ER)V0(gz,m-z2,im,in,ER)V0(d0,Xi,RX)
V0(z6,$5(m,c&Xg,c|Xg,1&c<Xg,1&c>Xg,1&c==Xg),im,cc,RX)

V0(Z6,1>m?Ag&Xg:Ag|Xg,im,EA,RX)
#define ft(m,o,O,t,T) T##f(O##t,i(6-m,x=O##T(x,S##m(i,x)))x)i2(o##t,O##t(r(z0,i(n##m(n),r=O##T(r,Xi))))[b(6-m)],in,IX)V(o##T,T##z=z2;N##m(z=O##T(z[b(6-m)]-z2,O##t(Xi))),RX)
#define b4(g,a,b,Y...) e2(g,Se(r(ze,n=n2(n);Ez[4]={};i(n/4,i(4,zi+=a*X++))i(n%4,r+=b Xi)i(4,r+=zi)))[15],Y)
b4(se,,,in,EX)b4(vv,*R++*,Ri*,RX)ft(0,s,S,g,G)ft(0,m,M,g,G)ft(2,m,M,i,I)ft(2,s,S,i,I)e2(me,ii=mi(n,X);*(e2*)&i,in,EX)i2(s2,i(n2(n),Ub=b2(m==Xi);P(b,16*i|iu(b)))n,im,in,IX)
V2(ig,IG(X4),RX)V2(ei,EI(Xi),RX)V2(ie,IE(Xi),RX)V2(r2,R2(*--X),RX)V2(IV,$9(m,A6+Xi,A6-Xi,A6*Xi,G2(A,Xi),Ai+Xi,Ai-Xi,Ai*Xi,Ai/Xi,Ai*Xi/(1+E(-Xi))),im,EA,RX)
V2(eV,$4(m,e+Xi,e-Xi,e*Xi,e/Xi),im,ee,RX)V2(iV,$5(m,j+X6,j-X6,j*X6,x((i1)j*X6>>16,j>>16?X6-(j>>16)*x:x),1&GI($3(m-6,j<X8,j>X8,j==X8))),im,ij,RX)V2(eZ,E(Xi),RX)V2(qZ,Q(Xi),RX)
V2(dV,e*Xi,ee,RX)V(sZ,ee=me(n,X);N2(E(Xi-e))e=1/se(n,R);N2(e*Ri),RX)V(RZ,ee=1/Q(vv(n,X,X)/n-ze)[0];N2(e*Ai*Xi),EA,RX)

G(a2,3>tx|5<i?bc(i,$9(i,b+c,b-c,b*c,0,l(b,c),m(b,c),b<c,b>c,b==c)):bc(e,$6(i,b+c,b-c,b*c,b/c,l(b,c),m(b,c))))G(QZ,0)G(QR,1)f(qz,0)

Z2 b[]={3,0,2,0,0,2,3,3},o,W;ZU B=1l<<32,O[256],z[30];U(bn,lu(m(64,(U)n<<b[t]))-6,it,in)g(_M,W-=1<<i;*(U*)x=zi;zi=x)Ui(M_,Ux=zi;P(x,W+=1<<i;zi=*(U*)x;x)QQ(i>29)_M(i,M_(i+1))+(64L<<i))
f(_o,qx?_M(hx,(U)sx):_m((U)sx,nx);Ox=o;o=ox;x)G(o_,a=t(8+i,a);ii=o;QQ(i>>8)o=Oi;Oi=x;(U)i<<32|a)U(tn,Ux=bn(t,n);x<<54|o_(t,n,M_(x)),it,in)F(u_,Ox|=a<<47;1L<<53|x)f(_u,Ox&=b(47);~(1L<<53)&x)
U(oz,i(256,Oi=i+1)i(30,zi=B+(64l<<i))0)g(p,cc=Nx%64;if(c)$(i,xV[Nx>>6]|=I0>=c)xV[Nx>>6]&=I0<c;x)f(_r,63&Ox?(--Ox,x):_o(x))f(r_,QQ(!(63&++Ox))x)U(ln,R(tx,n,d0(n<<bx,sr,sx+(i<<bx))),ii,in,Ux)

g(s,_x(3>tx?t(tx,(bx?1&i?si:mi:1&i?sg:mg)(nx,sx)):te((1&i?se:me)(nx,sx))))//over scan atom +-*%&|<>=~ !@? #_^
G(o7,p(0,x);a?__(te(vv(nx,sa,sx))):s(1&i,x))G(o3,P(17==a,_u(x))Qz(1!=a&6!=a)P(31>i,s(1&a,p(0,x)))Qz(mx|2-tx)X((2>a?sI:mI)(u)))

V(mv,ir=R;i(m,ri=vv(n,A+n*i,X)),im,eA,RX)V(vm,n/=16;i(n/4,Ez[4]={};i(m,j(4,zj+=Ai**X++)X+=n-4)X-=m*n-4;j(4,*R++=zj)),im,eA,RX)V(mm,,ij,im,EA,RX)//n/=16;h(l/4,i(n/4,Ez[4][4];i(m,i(4,j(4,))R[h][i]=,il,im,EA,RX)
//V(m4,Ez[16]={};i(16,zi=X[n*i])i(16,R[n*i]+=r(ze,j(16,r+=A[m*i][j]*zj))),im,in,ER,EA,EX)V(mm,l/=16;n/=16;i(m/=16,j(n,h(l,m4(m,n,R+n*(16*i)+j,A+m*(16|h)+i,X+n*(16|h)+j)))),il,im,EA,RX)

