#define T(t,n,e) R(t,n,i(n6(Nr),rz=(e)))
#define T0(e) R(0,nx,i(nr,Q(ru=(e)))) 
#define T1(e) T(1,nx,1&(e))
#define zX    T(3,nx,TV(IZ,xx))
#define zY(j) T(5,nx,j?TV(UZ,(IY)xy)<<32:TV(UZ,(IY)xy))
#define Tx(e) _x(T(tx,nx,e))
//acempsv|fi rtwxyz bciegn +*ieg <=cin QR[[&|<>=@?#^]i &I I!]
//ACEMPSV|F QRTW    123456 QZ ""23 "'a0"x V@?V M@M &M *%^?<>=V //at b cut d each f geo [hijkl] max num [o] prd [q] r sum type [u] vcat write xyz
#include"_.c"//! #$%&'()*+, -./:;<=>?@[\]^_{|}~   +-*%&|<>=~$.!@?#_^,
ZZ F[2];Zc*f="@-@0+$%489#!3\",5 7')(/.:6;21<&=*";zz(p_,Z a=48>x;Z b=58>x;Z c=65>x;Z d=97>x;Z e=123>x;b&~a&x+16|e&~d&x-64|a&z(*F,x-32)|z(F[1],c&~b&x-58|d&~c&x-84|~e&x-111))
iu(ua,i==tx?x:t(i,3<i&&4>tx?ie(ix):ix))f(u1,c3(m(2,tx)-2,zX,T(4,nx,TV(EZ,(IZ)xz)),zY(0)))iu(uv,i==tx?x:uv(i,u1(x)))iu(av,ax?ua(i,x):uv(i,x))au(uU,uf=*a;it=m(tf,tx);*a=av(t,f);uv(t,x))
iu(a_,tx?t(tx,l3(xc,xi,xu)):R_(xu))nu(na,uy=5==tx?gx:ix;ii=lx;W(i<3)y|=y<<(8<<i++);T(tx,n,y-Z3))f(l_,R(tx,1,*(u*)sr=5>tx?x:gx))_u(e,_x(T0(f_(a_(i,x)))))
f(s,in=0;N(n+=xc)n)f(ind,_x(R(3,s(x),i2*s=sr;N(if(xc)*s++=i))))un(n,T(3,N&n?-n:n,16*i+NZ))f(n_,ax?n(ix):_(Qt(1<tx)ind(x)))
fU(c,Z*s=sy+(f<<ly);T(ty,x,s[i]))fu(pr,x=c(-1,nx,x);*sx=f;x)nu(ec,T1((i0)n==xz))
F(C,x=ind(x);_xy(T0(c(xi,(i+1<nx?((i2*)sx)[i+1]:ny)-xi,y))))f(Cc,x=C(pr(1,ec(sx[nx-1],x)),x);N(--xu;sxu[nxu]=0)x)f(_C,_x(R(2,0,N(r=V(r,xu)))))nu(cC,N(sxu[nxu]=n;++xu)_C(x))
f(s0,32>x?ns(1,F+64+x):ax?4>tx?si(ix):5>tx?se(ix):sg(gx):1==tx?_x(T(2,nx,48+xz)):2==tx?x:e(s0,x))f(s1,ax||2>tx-1?s0(x):tx?cC(32,e(s0,x))-1:ks(".."))f(wx,Q(x)x?w(tx?s1(x):cC(10,e(s1,x))):0)
#define fe(g) f(_##g,uE;ax?te(i2(g(Ix))):tx?Tx(g(xz)):e(_##g,x))
f(_s,uI;ax?t3(ti(-ix),N^x,(N>>2|(u)N>>2<<30)^x):tx?Tx(4>tx?-(IZ)xz:-(EZ)xz):e(_s,x))f(no,ax?tb(!ix):tx?_x(lx?xZ(0==(IZ)xz):ec(0,x)):e(no,x))fe(p)fe(q)
f(G,ax?tg(x<<32):zY(1))f(_G,ax?te(_g(x>>30)):yZ(1))f(G_,ax?te(_g(x)):yZ(0))f(d_,uE;5>tx?G(x):_G(x))f(nd,5>tx?n_(x):G_(x))
#define SP(g,o) fu(g,f=3>tf?av(3,f):f;uI;UU;ax?af?c3(m(tf,tx)-3,ti((i2)f o ix),te(ie(ef o ex)),tg(i3(S==g?Gf+Gx:PG(Gf,Gx)))):g(x,f):_F(Tx(t3(IF o xz,EF o xz,S==g?EF+xz:PG(fz,xz)))))
#define LE(g,o) fu(g,Qt(4<tf||4<tx)UU;ax?af?tb((i2)f o ix):L_==g?g(_s(x),_s(x)):g(x,f):_F(_x(lx?xZ(IF o xz):T1(CF o xz))))
SP(S,+)SP(P,*)LE(L_,<)LE(E_,==)fu(V_,f=af?l_(f):f;x=ax?l_(x):x;UU;_x(V(f,x)))iu(_a,QZ)fu(A_,QZ)
iU(a5,Qz(2>i)Qt(3<tx)Qz(!ay)ti(c3(i-2,iy%ix,iy*ix,iy/ix)))iU(A5,Qz(3>i)Qt(3<tx)Qz(!ay)4>i?a_(iy,x):_a(iy,x))nu(c_,c(0,n,x))nu(_c,c(n,nx-n,x))
iU(s3,Qt(3<tx)Qn(N&ix)Qz(i)na(ix,y))iU(S3,Qz(1<i)in=ix>>31;Qn((n?-ix:ix)>ny)_y(2>i?(n^i?_c:c_)(n?ix+ny:ix,y):T0(c(i*ny/ix,ny/ix,y))))
qr(srt,QZ)qr(uni,QZ)qr(rr,A_(x,n(-nx)))qr(_l,_x(a_(0,x)))qr(_n,_x(ti(nx)))f(qz,QZ)f(__,x)Z_ a[]={__,qz,_s,qz,_p,qz,rr,qz,qz,qz,no,s0,d_,n_,_l,uni,_n,_q,srt,l_};//+-*%&|<>=~$.!@?#_^,
iU(A,ij=1&--i;10>i?c5(i/2,S(x,j?_s(y):y),P(x,j?_p(y):y),QZ,L_(j?y:x,j?x:y),j?no(E_(x,y)):E_(x,y)):15>i?(ax?a5:A5)(i-10,x,y):18>i?_(Qz(!ax)(ay?s3:S3)(i-15,x,y)):V_(x,y))
Zu U[32],ys();//pvcpvp
du(d,ii=*(*_)++;ij=i%32;96>i?c3(i/32,j,R_(U[j]),ti(j)):j?x(d(s,_),Q(x)160>i?a[j](x):y(d(s,_),Q(y)A(j,x,y))):_(u*a=U+*(*_)++%32;_R(*a);*a=d(s,_);0),ss,i0**_)f(D,ss=sx;d(0,&s))
fu(prr,w(x);Zy=32+Z0;in=i_(f);y[n++]=94;wx(ns(n,&y));Q)f(ln,~x&x>>1)f(an,x&x>>1)fu(nva,*zx+=96*_b(f);f=ln(f);*zx=64*_b(f)+s2(f,*zx);x)
us(ps,ux=ks(s);*zx&=(i0)nx>nZ;i(3,Qp(b("\"` "[i]==*zx)))Qp(an(b(10>*zx-48)))*zx=p_(*zx);Qp(b(12>*zx-20))uf=B(nx-1)&b(20>*zx);if(f)nva(f,x);x)
us(es,ux=ps(s);Q(x)_x(D(x)))us(ws,*s?wx(92==*s?ys(s):es(s)):0)us(ts,ux=ps(s);Q(x)in=1e6;uf=u_();i(n,Q(_R(D(x))))_x((m(f,u_())-f)/eu-2*n/1e6))
us(f1,in=nF(s);Qs(!n,s)R(2,n,ii=f_((u)s,0);_w(i,(u)sr,(u)n);_f(i)))us(f0,ux=f1(s);Q(x)Qd(10!=sx[nx-1])Cc(x))
us(ls,ux=f0(s);ii=-1;W(++i<nx&&nxu)Q(ws(sxu))_x(0))us(ys,c3(i_(b(*++s==*(Z*)"ltw")),ls(s+2),ti(ts(s+2)),ti(nw(0))))
int main(int _,char**a){oO(0);i(2,F[i]=*(Z*)(f+16*i)-32;X*a=F+i;a3=a2=a1=*a)$(*++a,ls(*a))w(ks("k/fun (c) atw 1974-2024"));bs[64];W(1)w(32),s[_w(0,(u)s,64)-1]=0,ws(s);}
