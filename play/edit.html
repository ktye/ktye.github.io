<!DOCTYPE html><head><meta charset="utf-8"><link rel=icon href="../kelas16.png"><title>new</title><style>
/*body{margin:0;min-height:100vh;display:flex;justify-content:center;align-items:center;background:#f0f0f0;}*/
*{font-family:monospace;font-size:24px}
canvas{background:grey}
textarea{width:100%}
</style></head><body>

<h1 id="h1"></h1>
<canvas id="cnv" width="800" height="450"></canvas><br/>
<input type="text" id="re"></input>
<button onclick="add()">add</button>
<hr/>
<textarea rows="12" id="out"></textarea>

<script>
let ctx=cnv.getContext("2d");
let ch=document.location.hash.slice(1)
if(ch!=""){im="m/"+ch+".webp";let img=new Image();img.onload=_=>ctx.drawImage(img,0,0);img.src=im;document.title=ch;h1.textContent=ch
}else alert("missing hash");

fetch("story").then(r=>r.text()).then(r=>out.value=r.split("\n").filter(x=>x.startsWith(ch+"|")).join("\n")+"\n")


let X=0,Y=0;
cnv.onmousedown=e=>{X=e.offsetX;Y=e.offsetY;}
cnv.onmouseup=e=>{let x=e.offsetX;y=e.offsetY;console.log("up",X,Y); if(x-X>10&&y-Y>10)rect(X,Y,x-X,y-Y); }
let rect=(x,y,w,h)=>{ctx.strokeStyle="red";ctx.strokeRect(x,y,w,h);re.value=[x,y,w,h].join(" ")};

let add=_=>{
 let r=re.value.split(" ")
 out.value+=ch+"|"+r+"|\n"
}

</script></body></html>
