<!DOCTYPE html><head><meta charset="utf-8"><link rel=icon href="../kelas16.png">
<title>snake</title><style>
body{font-family:monospace;font-size:xxx-large;margin:0;min-height:100vh;display:flex;justify-content:center;align-items:center;background:#f0f0f0;}
canvas{width:min(100vw,100vh);height:min(100vw,100vh);background:black;image-rendering:pixelated;}
</style></head><body><canvas id="cnv" width="30" height="30"></canvas><script>
let min=Math.min,max=Math.max,abs=Math.abs,sqrt=Math.sqrt,hypot=Math.hypot,floor=Math.floor
let cos=Math.cos,sin=Math.sin,sign=Math.sign,asin=Math.asin,atan2=Math.atan2
let rand=_=>Math.random()

const W=30
let rnd=(i,j)=>{i=1+floor((W*W-4*W+4-S.length)*rand());for(j=0;j<W*W;j++)if(!da[j])if(!--i)return j}
let S=[0,1].map(x=>x+floor(W*W/2+W/4)),D=1,G=0,R=[]

const ctx=cnv.getContext("2d");ctx.imageSmoothingEnabled=false;
const im=ctx.getImageData(0,0,cnv.width,cnv.height)
const da=new Uint32Array(im.data.buffer);
const white=0xffffffff,red=0xff0000ff
for(let i=0;i<W;i++){da[i]=white;da[i+W*W-W]=white;da[W*i]=white;da[W*i-1]=white}
let left=_=>R.push(-1),right=_=>R.push(1),up=_=>R.push(-W),down=_=>R.push(W)
let gameover=_=>{clearInterval(req);history.back()}
S.forEach(x=>da[x]=white);da[rnd()]=red
let draw=_=>{let h,d
 d=R.shift();D=(d&&D!=-d)?d:D
 G?--G:(da[S[0]]=0,S.shift())
 h=S[S.length-1]+D;S.push(h);if(da[h]==red){G+=3;da[rnd()]=red;da[h]=0}if(da[h])gameover();da[h]=white;
 ctx.putImageData(im,0,0)}
req=setInterval(draw,200)

let pd=e=>(e.preventDefault(),e.stopPropagation())
cnv.onpointerup=e=>pd(e);cnv.onpointerdown=e=>{pd(e);
 let r=e.target.getBoundingClientRect(),x=(e.clientX-r.left)/r.width,y=(e.clientY-r.top)/r.height
 x<0.3?left():x>0.7?right():y<0.3?up():y>0.7?down():0}

window.onkeydown=(e,k)=>{k=e.key;k=="ArrowLeft"?left():k=="ArrowRight"?right():k=="ArrowUp"?up():k=="ArrowDown"?down():0}

</script></body></html>
